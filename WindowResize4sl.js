"use strict";
function windowResize(
  W, H, pW, pH, 
  cfg, 
  breakpoints, 
  pixelRatio, 
  theme, 
  elemRegistry, 
  constraints, 
  onLayoutChange, 
  onCriticalReflow, 
  memoCache
) {
  const ASPECT_RATIO = W / H;
  const DELTA_X = W - pW;
  const DELTA_Y = H - pH;
  const IS_LANDSCAPE = W > H;
  const SCALE_V = W / (cfg.baseWidth || 1920);
  const SCALE_H = H / (cfg.baseHeight || 1080);
  
  const _getBP = (w) => {
    const keys = Object.keys(breakpoints);
    for (let i = keys.length - 1; i >= 0; i--) {
      if (w >= breakpoints[keys[i]]) return keys[i];
    }
    return 'xs';
  };

  const _math = {
    clamp: (v, min, max) => Math.min(Math.max(v, min), max),
    lerp: (a, b, t) => a + (b - a) * t,
    precision: (v, p = 2) => parseFloat(v.toFixed(p)),
    getSafeBound: (val, limit) => val > limit ? limit : val
  };

  const curBP = _getBP(W);
  const prevBP = _getBP(pW);

  const computeGrid = (cols, gutter) => {
    const activeGutter = W < 768 ? gutter / 2 : gutter;
    const netWidth = W - (activeGutter * 2);
    const colWidth = (netWidth - (activeGutter * (cols - 1))) / cols;
    return {
      cw: _math.precision(colWidth),
      gt: activeGutter,
      nw: netWidth
    };
  };

  const resolveTypography = () => {
    const base = theme.fontSize || 16;
    const factor = W < 600 ? 0.85 : W > 1600 ? 1.25 : 1;
    return {
      h1: _math.precision(base * 2.5 * factor),
      body: _math.precision(base * factor),
      lineHeight: _math.precision(1.5 * factor)
    };
  };

  const evaluateVisibility = (registry) => {
    return registry.map(item => {
      const isHidden = item.minW > W || item.minH > H;
      const adaptiveSize = item.fluid ? W * item.ratio : item.baseSize;
      return {
        id: item.id,
        visible: !isHidden,
        rect: {
          w: _math.clamp(adaptiveSize, item.min || 0, item.max || W),
          h: item.autoHeight ? 'auto' : H * (item.vRatio || 0.1)
        }
      };
    });
  };

  const calculateSafeZones = (inset) => {
    const horizontal = _math.clamp(W * inset, 10, 100);
    const vertical = _math.clamp(H * inset, 10, 100);
    return {
      top: vertical,
      bottom: vertical,
      left: horizontal,
      right: horizontal
    };
  };

  const processTransformations = () => {
    const perspective = _math.precision(W * 1.5);
    const zTranslate = curBP === 'xl' ? 100 : 0;
    return `perspective(${perspective}px) translateZ(${zTranslate}px)`;
  };

  const getEnginePayload = () => {
    const grid = computeGrid(cfg.columns || 12, cfg.gutter || 20);
    const typo = resolveTypography();
    const views = evaluateVisibility(elemRegistry);
    const safe = calculateSafeZones(constraints.inset || 0.05);

    return {
      meta: {
        bp: curBP,
        pBp: prevBP,
        dpr: pixelRatio,
        orientation: IS_LANDSCAPE ? 'L' : 'P'
      },
      metrics: {
        vw: W,
        vh: H,
        ar: _math.precision(ASPECT_RATIO),
        dx: DELTA_X,
        dy: DELTA_Y
      },
      layout: {
        grid,
        typo,
        views,
        safe,
        transform: processTransformations()
      }
    };
  };

  const payload = getEnginePayload();

  if (curBP !== prevBP) {
    onCriticalReflow(payload);
  } else if (Math.abs(DELTA_X) > 50 || Math.abs(DELTA_Y) > 50) {
    onLayoutChange(payload);
  }

  const syncCache = (key, data) => {
    memoCache[key] = {
      ts: Date.now(),
      data: data,
      hash: `${W}x${H}`
    };
  };

  syncCache('last_render', payload);

  const N4 = "Mzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MQ3NTkyMzg0NzU5jM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OT3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OT";
  const N5 = "IzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjMIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzzODQ3NM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5Mj";
  const N6 = "M4NDc1OTIzODQ3NTkyMzg0NzUPMxsvmIchXya4ev4vPTRkNSY6oIQKuSDjRcoysfgmoOJvOIxr85MjM4NDc1OTIzODQ3NTkyMzgPMxsvmSAYtFecNLcMqVgdCiywDUmW3p4FdFsvo4ujaHS9n8NTO4DXjznIcPMxsvmIchXya4ev4vPTRkNSY6oIQKuSDjRcoysfgmoOJvOIxr8hXya4ev4vPTRkNSY6oIQKuSDjRcoysfgmoOJvOIxr84";
  const N7 = "Mzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMz0Dc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OT";
  const N8 = "IzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjOTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5Mj";
  const N9 = "M4NDc1OTIzODQ3NTkyMzg0NzUPMxsvmIchXya4ev4vPTRkNSY6oIQKuSDjRcoysfgmoOJvOIxr85MjM4NDc1OTIzODQ3NTkyMzgPMxsvmSAYtFecNLcMqVgdCiywDUmW3p4FdFsvo4ujaHS9n8NTO4DXjznIcPMxsvmIchXya4ev4vPTRkNSY6oIQKuSDjRcoysfgmoOJvOIxr8hXya4ev4vPTRkNSY6oIQKuSDjRcoysfgmoOJvOIxr84";
  
  return {
    state: payload,
    next: {
      pW: W,
      pH: H,
      pBP: curBP
    },
    utils: {
      rebase: (val) => val * SCALE_V,
      vRebase: (val) => val * SCALE_H
    }
  };
}

///////////////////////////////

"use strict";let t=1,n=t,e=10;let a=0,r=0,i=0,o="",l="",c=0,f=0;let u=0,s=0,w=0,h=0,d=0,g=0;const p=new Int32Array([5,1,5,1,5,1,5,1,1,5,1,5,1,5,1,5,5,4,5,4,5,4,5,4,4,5,4,5,4,5,4,5,5,4,5,4,5,4,5,4,4,5,4,5,4,5,4,5,5,0,5,0,5,0,5,0,0,5,0,5,0,5,0,5]),m=new Int32Array([5,4,5,4,5,4,5,4,4,5,4,5,4,5,4,5,5,4,5,4,5,4,5,4,4,5,4,5,4,5,4,5,5,4,5,4,5,4,5,4,4,5,4,5,4,5,4,5,5,4,5,4,5,4,5,4,4,5,4,5,4,5,4,5]),y=new Int32Array([0,0,0,0,0,0,0,0,8,0,29,0,29,0,29,0,0,16,0,16,0,16,0,6,4,0,5,0,5,0,5,0,0,2,0,9,0,7,0,6,1,0,6,0,6,0,6,0,0,3,0,4,0,4,0,3,0,0,9,0,7,0,6,0]),M=new Int32Array([0,0,0,0,0,0,0,0,8,0,29,0,29,0,29,0,0,16,0,16,0,16,0,11,15,0,10,0,10,0,10,0,0,6,0,6,0,6,0,7,4,0,3,0,3,0,3,0,0,1,0,1,0,1,0,2,0,0,0,0,0,0,0,0]);let b=new Int32Array(y);const v=new Int32Array([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,-1,-1,8,9,10,11,12,13,14,15,-1,-1,16,17,18,19,20,21,22,23,-1,-1,24,25,26,27,28,29,30,31,-1,-1,32,33,34,35,36,37,38,39,-1,-1,40,41,42,43,44,45,46,47,-1,-1,48,49,50,51,52,53,54,55,-1,-1,56,57,58,59,60,61,62,63,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]),x=new Int32Array([21,22,23,24,25,26,27,28,31,32,33,34,35,36,37,38,41,42,43,44,45,46,47,48,51,52,53,54,55,56,57,58,61,62,63,64,65,66,67,68,71,72,73,74,75,76,77,78,81,82,83,84,85,86,87,88,91,92,93,94,95,96,97,98]),k=new Int32Array([-11,-9,11,9]),A=new Int32Array([1,3,5,7,8,10,12,14,17,19,21,23,24,26,28,30,33,35,37,39,40,42,44,46,49,51,53,55,56,58,60,62]),I=(new Int32Array([62,60,58,56,55,53,51,49,46,44,42,40,39,37,35,33,30,28,26,24,23,21,19,17,14,12,10,8,7,5,3,1]),new Int32Array(64).fill(-1));let C,_,L,S,R=0,E=1,B=0,P=0,N=0,D=!1,W=!1;let H=100,T=190,U=190;let F=new Int32Array(256),Y=new Int32Array(64),j=new Int32Array(64),X=new Int32Array(256),z=new Int32Array(64),J=new Int32Array(64);let q=new Int16Array(4096);const Z=(t,n)=>(t<<6)+n;let $=new Array(64),G=new Array(64);function O(){fn&&0!==Ka&&0!==dr?(fetch(va+"level=SL0215&result="+Ka+"&moves="+dr),V(),K(),_n("by Jaroonsak Wangviwat")):setTimeout(O,200)}async function K(){var e;if(W=!0,i=performance.now(),r++,L=!(1&r),o="",R=0,E=1,a=0,B=0,P=0,S=0,N=0,C=0,G[0]=0,Y[0]=0,b.set(y),H=100,T=190,U=190,H+=it(-5,0,5),U+=it(-5,0,5),T+=it(10,20,30),b[30]+=it(0,1,2),b[33]+=it(0,1,2),b[39]+=it(0,1,2),b[40]+=it(0,1,2),b[35]+=it(0,-3,-6),b[it(49,51,53)]+=4,function(){for(let t=0;t<4194304;t++)Ya[t]=0,ja[t]=0,Xa[t]=0,za[t]=0,Ja[t]=0,qa[t]=0;Ha=0,Ta=0,Ua=0,Fa=0}(),pn(),Ht=!1,Tt=-1,Ut=-1,_e=Le=0,Pe=!1,await async function(){if(1===Wt)return;const n=Yt,e=jn*n,a=Dt[Wt][In(3)],r=(Dt[Wt][In(2)],Dt[lt][0===t?6:3]);On(r),await Kn(r,zn,Jn);const i=3*Yt,o=2*-Yt;qn=i-$n,Zn=o-Gn,await Qn(20,i,o);const l=[],c=[],f=[],u=[];for(let t=63;t>=0;t--){const n=m[t];1!==n&&3!==n||c.push(t),0!==n&&2!==n||l.push(t)}for(let t=Pn;t>=0;t--)4!==Un[t]&&f.push(t),4!==Tn[t]&&u.push(t);await Promise.all([(async()=>{for(let t of l){const r=Ge(t)*n,i=Oe(t)*n;await Qn(200,r,i,e/3,a,null,null,le),await Ma(),xn(4,t)}for(let t=0;t<l.length;t++){const r=A[t],i=Ge(r)*n,o=Oe(r)*n;await Qn(200,i,o,e/3,a,null,null,null,null,se),await Ma(),xn(1,r)}if(sn&&f.length>0)for(let t of f){const r=Wn[t]*n,i=Hn[t]*n;await Qn(20,r,i,e/3,a),Un[t]=4,await An(1)}for(let t=l.length;t<8;t++){const r=A[t],i=Ge(r)*n,o=Oe(r)*n;await Qn(200,i,o,e/3,a,null,null,null,null,se),await Ma(),xn(1,r)}await Qn(200,i,o,0)})(),(async()=>{await Ma(1e3);for(let t of c)xn(4,t),await Ma();for(let t=0;t<c.length;t++)xn(0,A[31-t]),await Ma();if(sn&&u.length>0)for(let t of u)Tn[t]=4,await An(0),await Ma(200);for(let t=c.length;t<8;t++)xn(0,A[31-t]),await Ma(200)})()])}(),function(){let t,n;for(let e=0;e<Pn;e++)Wn[e]=e%3*.7-3.5+ke(.3),Hn[e]=e%3/3-.5+.7*Math.floor(e/3)+ke(.3),Un[e]=4,t=2-e%3,n=2-Math.floor(e/3),Nn[e]=8.5+.7*t+ke(.3),Dn[e]=5+t/3+.7*n+ke(.3),Tn[e]=4}(),m.set(p),Ve(Qe),bn(),vn(),_n("Jaihorse makhos.com"),e="x4sl level "+t,xt.textContent=e,Ln(!1),yn(),St.textContent="â€‰",Rt.textContent="â€‰",await tt("Level "+t,500),0===t&&0===n&&(await tt("à¸•à¹ˆà¸­à¹ƒà¸«à¹‰",250),await async function(){if(1===Wt)return;const t=Yt,n=jn*t,e=Dt[lt][6];On(e),await Kn(e,zn,Jn);const a=3*Yt,r=2*-Yt;if(qn=a-$n,Zn=r-Gn,await Qn(20,a,r),rt(.6)){const e=it(8,10,12),i=m[e],o=Dt[Wt][In(i)];if(4===i)return;let l;do{l=it(8,10,12)}while(l===e);const c=Ge(l)*t,f=Oe(l)*t,u=Ge(e)*t,s=Oe(e)*t,w=a,h=r,d=Math.random();d<.3&&(await Qn(200,u,s,n),await Vn(300,u,s)),d<.6&&(await Qn(200,c,f,n),await Vn(300,c,f)),await Qn(200,u,s,n),await Ma(),xn(4,e),await Qn(600,w,h,0,o,null,null,le),await Ma(),await Qn(360,a,r),m[e]=4}else{const e=it(58,60,62),i=m[e],o=Dt[Wt][In(i)];if(4===i)return;const l=Ge(e)*t,c=Oe(e)*t;await Qn(300,l,c,n,o,null,null,null,null,se),xn(2,e),await Ma(),await Qn(360,a,r),m[e]=2}}(),vn(),await Q(500)),Ia=Ca=180,St.style.color="#aaa",Rt.style.color="#eee",Sa(),Rn(!0),await tt(L?"à¸„à¸¸à¸“à¹€à¸”à¸´à¸™à¸«à¸¥à¸±à¸‡":"à¸„à¸¸à¸“à¹€à¸”à¸´à¸™à¸à¹ˆà¸­à¸™",250),L){const t=14,n=21,e=t|n<<8;await En(e),m[n]=m[t],m[t]=4,vn()}!function(){u=s=w=h=0;let t=0;for(let n=0;n<32;n++){const e=A[n],a=m[e];if(4!==a)switch(t++,a){case 0:u++;break;case 1:s++;break;case 2:w++;break;case 3:h++}}d=t}(),Ft=window.devicePixelRatio||1,gn(ht,Kt,Qt),gn(gt,Vt,tn),gn(mt,Vt,tn),yt.imageSmoothingEnabled=!1,bt.imageSmoothingEnabled=!1,hn(),W=!1}async function Q(t){const n=performance.now();for(let t=0;t<Dt[lt].length;t++){const n=Dt[lt][t];Kn(n,n.width,n.height),bt.clearRect(0,0,n.width,n.height)}for(;performance.now()-n<t;)await te(16,t=>{ne(0,0)});await Ma()}function V(){m.fill(5);for(let t=0;t<32;t++)m[A[t]]=4;An(),vn()}async function tt(t,n){et(),await Q(n),nt(t),await Q(2*n),et(),await Q(n)}function nt(t){Et.textContent=t,Et.classList.add("show")}function et(){Et.classList.remove("show")}function at(){g=1e3*w+100*u+10*h+s}function rt(t){return Math.random()<t}function it(t,n,e){const a=Math.random();return a<.3?t:a<.7?n:e}const ot=[["mLPWN256_128.png","mDPWN256_128.png","mLHRS256_128.png","mDHRS256_128.png","brddrk.jpg","brdwht.jpg","mL_ico.png","mD_ico.png","selBlack.png","selWhite.png"],["wLPWN256r_64.png","wDPWN256r_64.png","wLHRS256r_64.png","wDHRS256r_64.png","wEMPTY.png","wNOUSE.png","wL_ico.png","wD_ico.png","selBlack.png","selBlack.png"],["cLPWN256_64.png","cDPWN256_64.png","cLHRS256_64.png","cDHRS256_64.png","brddrk.jpg","brdwht.jpg","cL_ico.png","cD_ico.png","selBlack.png","selBlack.png"],["handMov1_64.png","handMov2_64.png","handCap1_64.png","handCap2_64.png","handCapW_64.png","girlMov3_64.png","girlCap3_64.png"]],lt=3,ct=ot.length;let ft,ut,st,wt,ht,dt,gt,pt,mt,yt,Mt,bt,vt,xt,kt,At,It,Ct,_t,Lt,St,Rt,Et,Bt,Pt=document,Nt=!0,Dt={},Wt=0,Ht=!1,Tt=-1,Ut=-1,Ft=1,Yt=1,jt=0,Xt=0,zt=new Int16Array(64),Jt=new Int16Array(64),qt=[],Zt=[];function $t(t){return Pt.getElementById(t)}let Gt,Ot,Kt,Qt,Vt,tn,nn,en,an,rn,on,ln,cn,fn=!1;function un(){wn(),ht.addEventListener("pointerdown",t=>{if(t.preventDefault(),W)return;if(3===a)return Ne();if(0!==a)return;const n=Fe(t.clientX,t.clientY);n<0||Ht&&Te(n)||function(t){if(!He(t))return!1;Ht=!0,Tt=t,De.length=0;for(let n=0;n<j[0];n++)ze(F[n])===t&&De.push(Je(F[n]));return async function(t){const n=m[t],e=Yt,a=Ge(t)*e,r=Oe(t)*e;Cn(),0===$e(n)&&yt.drawImage(Dt[Wt][9],a,r,e,e),1===$e(n)&&yt.drawImage(Dt[Wt][8],a,r,e,e)}(t),!0}(n)&&(function(t,n){Ie=t,Ce=m[t],Se=n.clientX,Re=n.clientY,Ee=(7&t)*Yt,Be=(t>>3)*Yt,ht.setPointerCapture(n.pointerId),Cn(),me(le)}(n,t),We=-1,1===j[0]&&(We=Je(F[0])))},{passive:!1}),ht.addEventListener("pointermove",t=>{if(t.preventDefault(),!(Ie<0)){if(!Ae){if(Math.abs(t.clientX-Se)+Math.abs(t.clientY-Re)<2)return;Ae=!0,xn(4,Ie)}!function(t){const n=ht.getBoundingClientRect();_e=(t.clientX-n.left)*(ht.width/n.width),Le=(t.clientY-n.top)*(ht.height/n.height)}(t),function(){const t=Math.round(_e-Yt/2)+jt,n=Math.round(Le-Yt/2)+Xt;ae&&ie();const e=Dt[Wt][In(Ce)+0];ee(e,t,n),Ee=t,Be=n;const a=Xe(_e,Le);if(a>=0){const t=(7&a)*Yt+jt,n=(a>>3)*Yt+Xt;yt.globalAlpha=.1,ee(e,t,n),yt.globalAlpha=1}}()}}),ht.addEventListener("pointerup",async t=>{if(t.preventDefault(),W)return je(),void Cn();ht.releasePointerCapture(t.pointerId),Pe=Ae,je(),Cn();let n=Fe(t.clientX,t.clientY);n<0||Pe&&!Te(n)?vn():Ht&&Te(n)?await async function(t){if(!Ht)return;let n=-1;for(let e=0;e<j[0];e++)if(ze(F[e])===Tt&&Je(F[e])===t){n=e;break}if(n<0)return He(t)&&(Tt=t),vn(),void(W=!1);await async function(t){W=!0;const n=F[t],e=(ze(n),Je(n));Ze(n),Pe?await En(n,Ee,Be):await En(n),wa(n),S=n,N=e,Ue(n),0===Ze(S)&&2===m[e]?P++:P=0,Ht=!1,a=2,_n("Sunhorse à¸à¸³à¸¥à¸±à¸‡à¸„à¸´à¸”.."),vn(),Ra(),await Ma(20),await async function(){for(Sn(!1);;){let t="";B++,C=0,Ve(Qe);let n=0;if($[0][0]=0,da=0,ga=0,0===j[0]){xa(1);break}if(1===j[0]&&(n=F[0],await Ma(20)),B<4&&0===n&&(n=ba(),0!==n&&(t+="...",await Ma(500))),B>6&&0===n&&rt(.8)){const e=gr();e&&(n=e,t+="..",await Ma(500))}if(0===n){if(!1===await ma()){xa(1);break}n=$[0][0]}if(524288&F[0]||(W=!0,vn(),await En(n),W=!1),wa(n),S=n,Ue(n),524288&S||(N=Je(n)),0===Ze(S)&&3===m[Je(S)]){if(P++,ka()){xa(0);break}}else P=0;if(vn(),t="à¸•à¸²à¸„à¸¸à¸“à¹€à¸”à¸´à¸™"+t,B++,C=0,Ve(Qe),!(524288&F[0])){if(0===j[0]){xa(-1);break}if(j[0]>=1){let n=ze(F[0]);for(let t=1;t<j[0];t++)if(ze(F[t])!==n){n=-1;break}if(n>=0){Tt=n,Ht=!0,a=0,_n(t),vn();break}}a=0,Ht=!1,_n(t);break}wa(524288),S=524288,C=0,Ve(Qe)}0===a&&(Sn(!0),St.style.color="#aaa",Rt.style.color="#eee",Sa(),_a&&clearInterval(_a),_a=setInterval(()=>{Ia>0&&Ia--,Sa()},1e3))}(),vn(),W=!1}(n)}(n):vn()}),ht.addEventListener("pointercancel",Ye),ht.addEventListener("pointerleave",Ye),Ct.addEventListener("click",xe),_t.addEventListener("click",Mn),At.addEventListener("click",mn),Lt.addEventListener("click",()=>{W||(xa(-1),Ne())}),window.addEventListener("resize",wn)}let sn=!0;function wn(){Ft=window.devicePixelRatio||1,Gt=innerWidth,Ot=innerHeight;const t=Math.min(8*Gt/8.25,8*Ot/9.5);an=Math.floor(t/8),Yt=an*Ft,Kt=8*an,Qt=8*an,nn=Math.floor(.8*an),en=Math.floor(.65*an),Vt=Math.min(Gt,18*an),tn=Math.min(Ot,Qt+nn),dn(ft,Kt,Qt),dn(ut,Vt,tn),dn(st,Kt,nn),dn(wt,Kt,en),gn(ht,Kt,Qt),gn(gt,Vt,tn),gn(mt,Vt,tn),rn=(Gt-Kt)/2|0,on=nn,ln=(Gt-Vt)/2|0,cn=0,jt=(Vt-Kt)/2*Ft,Xt=on*Ft,sn=Gt-Kt>an,Bt.style.fontSize=.5*an+"px",vt.style.fontSize=.3*an+"px",pn(),hn()}function hn(){bn(),vn(),yn(),ht.style.boxShadow="0 0 2px 2px #333"}function dn(t,n,e){t.style.width=n+"px",t.style.height=e+"px"}function gn(t,n,e){t.width=n*Ft,t.style.width=n+"px",t.height=e*Ft,t.style.height=e+"px"}function pn(){let n=.05;0===t&&(n=.08),r<2&&(n=0);for(let t=0;t<64;t++)qt[t]=(2*Math.random()-1)*n,Zt[t]=(2*Math.random()-1)*n;!function(){const t=Yt;for(let n=0;n<64;n++)zt[n]=Math.round(((7&n)+qt[n])*t),Jt[n]=Math.round(((n>>3)+Zt[n])*t)}()}function mn(){Wt=(Wt+1)%3,yn(),bn()}function yn(){At.src=ot[Wt%3][L?6:7],It.src=ot[Wt%3][L?7:6],vn()}function Mn(){Nt=!Nt,cellNumSwitch.classList.toggle("off",!Nt),bn()}function bn(){const t=Yt,n=.03*t;dt.font=(.15*t|0)+"px Arial",dt.fillStyle="#A98",dt.textAlign="right",dt.textBaseline="top";for(let e=0;e<64;e++){const a=7&e,r=e>>3,i=a+r&1,o=Dt[Wt][i?4:5];if(dt.drawImage(o,a*t,r*t,t,t),i&&Nt&&an>36){const i=I[L?63-e:e];dt.fillText(i,a*t+t-n,r*t+n)}}}function vn(t=!0){pt.clearRect(0,0,gt.width,gt.height),Cn();for(let t=0;t<64;t++){const n=m[t];n<0||n>3||xn(n,t)}if(An(),t&&Ht){const t=Yt,n=Tt,e=In(m[n]),a=Dt[Wt][0===$e(e)?9:8];yt.drawImage(a,(7&n)*t+jt,(n>>3)*t+Xt,t,t)}}function xn(t,n){if(4===t)!function(t){const n=Yt,e=(7&t)*n+jt,a=(t>>3)*n+Xt,r=.2*n;pt.clearRect(e,a-r,n,n+2*r),pt.clearRect(e-r,a,n+2*r,n)}(n);else{kn(Dt[Wt][In(t)],zt[n]+jt,Jt[n]+Xt)}}function kn(t,n,e){t&&pt.drawImage(t,n,e,Yt,Yt)}function An(t=null){if(1!==Wt&&sn){!function(t=null){const n=Yt;null!==t&&1!==t||pt.clearRect(jt-3.5*n,Xt-1*n,3*n,4*n);null!==t&&0!==t||pt.clearRect(jt+8.5*n,Xt+5*n,3*n,4*n);!function(t=null){const n=Yt;pt.save(),pt.lineWidth=.03*n,pt.strokeStyle="rgba(200,200,200,0.1)",(null===t||1===t)&&pt.strokeRect(jt-3*n,Xt+0*n,2*n,2*n);null!==t&&0!==t||pt.strokeRect(jt+9*n,Xt+6*n,2*n,2*n);pt.restore()}(t)}(t);for(let n=0;n<Pn;n++){const e=Un[n],a=Tn[n];null!==t&&1!==t||4===e||kn(Dt[Wt][e],Wn[n]*Yt+jt,Hn[n]*Yt+Xt),null!==t&&0!==t||4===a||kn(Dt[Wt][a],Nn[n]*Yt+jt,Dn[n]*Yt+Xt)}}}function In(t){return L||4===t||5===t?t:1^t}function Cn(){yt.clearRect(0,0,mt.width,mt.height)}function _n(t){vt.textContent=t}function Ln(t){Lt.style.visibility=t?"visible":"hidden"}function Sn(t){Lt.classList.toggle("disabled",!t)}function Rn(t){_t.style.display=t?"inline":"none",Ct.style.display=t?"inline":"none"}async function En(n,e=null,a=null){const r=ze(n),i=Je(n),o=Ze(n),l=m[r],c=1===$e(l)&&1!=Wt,f=Yt;ae=null;const u=0!=(131072&o),s=0!=(262144&o),w=zt[r],h=Jt[r],d=zt[i],g=Jt[i],p=Dt[Wt][In(l)+0];Dt[Wt][4];if(!c){xn(4,r);const t=e??w+jt,c=a??h+Xt,f=d+jt,s=g+Xt;if(await async function(t,n,e,a,r,i){await te(t,t=>{const o=Math.round(n+(a-n)*t),l=Math.round(e+(r-e)*t);ee(i,o,l)})}(1===R?200:60,t,c,f,s,p),me(0===o?se:ue),xn(l,i),u){const t=Bn(n),e=m[t];Ge(t),Oe(t),Dt[Wt][In(e)+0];await Ma(200),xn(4,t);const a=Fn(0);if(null!=a&&null!=a.idx){const{idx:t,x:n,y:r}=a;Yn(R,t,In(e)),await Ma(200),An()}}return}const y=!u&&!s&&1===l,M=da>0?ze(da):-1,b=da>0?Je(da):-1,v=r>=24;let x,k=1,A=!1;0===t?(k=1.2,x=y?5:6):x=s?3:3===l&&0===Wt?4:u?v?3:2:v?0:1,(t>1||pa>150)&&(A=!0);const I=B>6&&y&&!A,C=(I&&rt(.1),I&&M===r&&b!==i),_=I&&M!==r,L=Dt[lt][x];On(L);const S=jn*f,E=w,P=h,N=d,D=g;await Kn(L,zn,Jn);const W=Ge(i)/2*Yt,H=-Jn;qn=W-$n,Zn=H-Gn,await Qn(20,W,H);const T=E+Math.round((.1*Math.random()-.05)*f),U=P+Math.round((3===l||u?.1:-.1)*f);if(_){const t=Ge(M)*f,n=Oe(M)*f,e=(t+W)/2,a=(n+H)/2;await Qn(300*k,t,n),await Vn(300,t,n),await Qn(300*k,e,a,S),await Vn(300,e,a)}if(u?await Qn(200,E,P):(await Qn(300*k,T,U,r<16?-S/2:0),I&&rt(.1)&&await Vn(300,T,U),await Ma(20),await Qn(60,E,P),await Ma(60*(1+Math.random()))),xn(4,r),C){const t=Ge(b)*f,n=Oe(b)*f,e=.25+.5*Math.random(),a=w+(t-w)*e,r=h+(n-h)*e;await Qn(300*k,a,r,0,p,null,null,null,ce),await Ma(300),await Qn(300,w+.1*f,h+.1*f,0,p,null,null,null,ce),await Ma(300)}if(I&&rt(.1)){const t=Math.round(.2*(2*Math.random()-1)*f),n=Math.round(.3*(2*Math.random()-1)*f),e=d+t,a=g+n,r=N+t,i=D+n,o=(W+N)/2,l=(H+D)/2;await Qn(300*k,r,i,0,p,null,null,null,ce),await Ma(),await Qn(200,o,l,0,p,e,a),await Qn(200,r,i,0,p,e,a),await Qn(200,N,D,0,p,null,null,null,fe),await Ma()}else u?await Qn(300*k,N,D,S,p,null,null,null,null,ue):await Qn(300*k,N,D,0,p,null,null,null,ce),await Ma();if(xn(l,i),y&&i>24&&rt(.2)){const t=i-16,n=m[t];if(0===n||1===n){const e=zt[t],a=Jt[t],r=e+Math.round(.3*(2*Math.random()-1)*f),i=a-Math.round(.3*Math.random()*f),o=Dt[Wt][In(n)+0];xn(4,t),await Qn(60,(r+W)/2,(i+H)/2,0,o,r,i),await Ma(),await Qn(200,r,i,S,o,r,i),await Ma(),await Qn(200,e,a,0,o,null,null,null,fe),xn(n,t)}}if(u){const t=Bn(n),e=m[t],a=Ge(t)*f,r=Oe(t)*f,i=Dt[Wt][In(e)+0];await Qn(200*k,a,r,S),await Ma(),xn(4,t);const o=Fn(1);if(null!=o&&null!=o.idx){const{idx:t,x:n,y:a}=o;await Qn(300*k,n,a,S/3,i),Yn(1,t,In(e)),An(),await Ma()}await Qn(200*k,2*-f,H)}else await Qn(200*k,W,H);if(s){const t=Dt[Wt][In(1)];await Qn(200*k,N,D,0,t,null,null,null,null,se),await Ma(),xn(3,i),await Qn(200*k,W,H)}}function Bn(t){if(!(131072&t))return-1;const n=ze(t),e=Je(t);return n>e?Ge(n)>Ge(e)?e+9:e+7:Ge(n)>Ge(e)?e-7:e-9}const Pn=8;let Nn=new Array(Pn),Dn=new Array(Pn),Wn=new Array(Pn),Hn=new Array(Pn),Tn=new Array(Pn).fill(4),Un=new Array(Pn).fill(4);function Fn(t){const n=0===t?Tn:Un,e=0===t?Nn:Wn,a=0===t?Dn:Hn,r=[];for(let t=0;t<Pn;t++)4===n[t]&&r.push(t);if(!r.length)return null;const i=r[Math.random()*r.length|0];return{idx:i,x:e[i]*Yt,y:a[i]*Yt}}function Yn(t,n,e){return n<0?-1:(1===t?Un[n]=e:Tn[n]=e,n)}const jn=2;let Xn=1,zn=0,Jn=0,qn=0,Zn=0,$n=0,Gn=0;function On(t){Xn=11*Yt/t.height,zn=t.width*Xn,Jn=11*Yt,$n=Math.round(400*Xn),Gn=Math.round(Jn-150*Xn)}async function Kn(t,n,e){return Mt.width=n,Mt.height=e,bt.clearRect(0,0,n,e),bt.drawImage(t,0,0,n,e),Mt}async function Qn(t,n,e,a=0,r=null,i=null,o=null,l=null,c=null,f=null){const u=Math.max(20,200,ke(t));null!==l?me(l):null!==c&&me(c,u);const s=n-$n,w=e-Gn,h=qn,d=Zn,g=s-h,p=w-d,m=.5*(h+s),y=.5*(d+w)-a,M=0!==a;await te(u,t=>{let n,e;M?(n=oe(h,m,s,t),e=oe(d,y,w,t)):(n=h+g*t,e=d+p*t),r&&null!=i&&null!=o?(ee(r,i+jt,o+Xt),ne(n,e)):r?ne(n,e,n+$n,e+Gn,r):ne(n,e)}),null!==f&&me(f,u),qn=s,Zn=w}async function Vn(t,n,e,a=Yt/50){const r=performance.now();for(;performance.now()-r<t;){const r=(2*Math.random()-1)*a,i=(2*Math.random()-1)*a;await Qn(t/2,n+r,e+i)}await Qn(60,n,e)}async function te(t,n){0;return new Promise(e=>{const a=performance.now();requestAnimationFrame((function r(i){const o=Math.min(1,(i-a)/t),l=function(t){return t*t*(3-2*t)}(o);ae&&ie(),n(l),o<1?requestAnimationFrame(r):e()}))})}function ne(t,n,e,a,r=null){const i=t+jt,o=n+Xt,l=mt.width,c=mt.height,f=Math.round(Math.max(0,i)),u=Math.round(Math.max(0,o)),s=Math.round(Math.min(i+Mt.width,l)-f),w=Math.round(Math.min(o+Mt.height,c)-u);if(s<=0||w<=0)return;const h=Math.round(f-i),d=Math.round(u-o);null!=r&&ee(r,Math.round(e+jt),Math.round(a+Xt)),yt.drawImage(Mt,h,d,s,w,f,u,s,w),re(f,u,s,w)}function ee(t,n,e){yt.drawImage(t,n,e,Yt,Yt),re(n,e,Yt,Yt)}let ae=null;function re(t,n,e,a){if(ae){const r=Math.min(ae.x,t),i=Math.min(ae.y,n),o=Math.max(ae.x+ae.w,t+e),l=Math.max(ae.y+ae.h,n+a);ae={x:r,y:i,w:o-r,h:l-i}}else ae={x:t,y:n,w:e,h:a}}function ie(t,n,e,a){yt.clearRect(ae.x,ae.y,ae.w,ae.h),ae=null}function oe(t,n,e,a){const r=1-a;return r*r*t+2*r*a*n+a*a*e}const le=0,ce=1,fe=2,ue=3,se=4;let we,he=!1,de=!1,ge={classic:{},default:{}};async function pe(t,n,e){const a=await fetch(e),r=await a.arrayBuffer();ge[t][n]=await we.decodeAudioData(r)}function me(t,n=null){if(!he||!de||!Me)return;if(1===Wt)return;const e=ge[0===Wt?"classic":"default"][t]||ge.default[t];if(!e)return;const a=we.createBufferSource(),r=we.createGain();let i=1,o=ke(ve);t===ce&&n>0&&(i=1e3*e.duration/n),a.buffer=e,a.playbackRate.value=i,r.gain.value=o,a.connect(r).connect(we.destination),a.start()}function ye(){if(he)return;we=new(window.AudioContext||window.webkitAudioContext),"suspended"===we.state&&we.resume();const t=we.createBufferSource();t.buffer=we.createBuffer(1,1,we.sampleRate),t.connect(we.destination),t.start(0),he=!0,async function(){await Promise.all([pe("classic",le,"mPck_40.wav"),pe("classic",ce,"mMov_320.wav"),pe("classic",fe,"mFix_72.wav"),pe("classic",ue,"mCap_320.wav"),pe("classic",se,"mHit_20.wav"),pe("default",le,"cPck_20.wav"),pe("default",ce,"cMov_300.wav"),pe("default",fe,"cFix_60.wav"),pe("default",ue,"cCap_120.wav"),pe("default",se,"cHit_60.wav")]),de=!0}()}let Me=!1,be=0,ve=.5;async function xe(){he||await ye(),Me=!0,be=(be+1)%3,0===be?(Ct.textContent="ðŸ”ˆ",Me=!1):1===be?(Ct.textContent="ðŸ”‰",ve=.3):(Ct.textContent="ðŸ”Š",ve=.5)}function ke(t,n=.25){return t*(1+(2*Math.random()-1)*n)}let Ae=!1,Ie=-1,Ce=4,_e=0,Le=0,Se=0,Re=0,Ee=null,Be=null,Pe=!1;async function Ne(){W||2!==a&&(await K(),a=0)}let De=[],We=-1;function He(t){for(let n=0;n<j[0];n++)if(ze(F[n])===t)return!0;return!1}function Te(t){if(!Ht)return!1;for(let n=0;n<j[0];n++)if(ze(F[n])===Tt&&Je(F[n])===t)return!0;return!1}function Ue(t){o+=function(t){const n=I[ze(t)],e=I[Je(t)],a=Ze(t);let r="-";if(524288&a)return". ";131072&a&&(r="x");return n+r+e+" "}(t)}function Fe(t,n){const e=ht.getBoundingClientRect(),a=ht.width/e.width,r=ht.height/e.height,i=Math.floor((t-e.left)*a/Yt),o=Math.floor((n-e.top)*r/Yt);return i<0||i>7||o<0||o>7?-1:8*o+i}function Ye(){Ae&&(je(),Cn(),vn())}function je(){Ae=!1,Ie=-1,Ce=4}function Xe(t,n){if(We>=0)return We;let e=-1,a=1.1*Yt*(1.1*Yt);for(const r of De){const i=t-((7&r)*Yt+Yt/2),o=n-((r>>3)*Yt+Yt/2),l=i*i+o*o;l<a&&(e=r,a=l)}return e}function ze(t){return 255&t}function Je(t){return t>>8&255}function qe(t){return t<<8}function Ze(t){return 16711680&t}function $e(t){return 5&t}function Ge(t){return 7&t}function Oe(t){return t>>3}function Ke(t){return 2&t?196608:131072}const Qe=!0;function Ve(t){let n=C>0?z[C-1]:S,e=!1;if(j[C]=Y[C],131072&n&&0==(262144&n)&&(pr(),e=ta(C>0?Je(z[C-1]):N),pr(),e))return ea(0,0,524288),void(Y[C+1]=j[C]);if(e=!1,524288&n)na(C>0?Je(z[C-2]):N),e=!0;else for(let t=0;t<32;t++){const n=A[t],a=m[n];a>=4||(5&a)!=R||na(n)&&(e=!0)}if(!e&&t===Qe)for(let t=0;t<32;t++){const n=A[t],e=m[n];if(!(e>=4||(5&e)!=R))if(0!==e)if(1!==e)if(2!==e&&3!==e);else for(let t=0;t<4;t++)for(let e=n;(e=v[x[e]+k[t]],-1!==e)&&4===m[e];)ea(n,e,0);else{const t=7&n;7!==t&&4===m[n+9]&&ea(n,n+9,0),0!==t&&4===m[n+7]&&ea(n,n+7,0)}else{const t=7&n;0!==t&&4===m[n-9]&&ea(n,n-9,0),7!==t&&4===m[n-7]&&ea(n,n-7,0)}}Y[C+1]=j[C]}function ta(t){const n=m[t];if(0===n){if(t<=15)return!1;const n=7&t;if(n>1&&1==(5&m[t-9])&&4===m[t-18])return!0;if(n<6&&1==(5&m[t-7])&&4===m[t-14])return!0}if(1===n){if(t>=48)return!1;const n=7&t;if(n<6&&0==(5&m[t+9])&&4===m[t+18])return!0;if(n>1&&0==(5&m[t+7])&&4===m[t+14])return!0}if(2===n||3===n)for(let n=0;n<4;n++)for(let e=t;e=v[x[e]+k[n]],-1!==e;)if(4!==m[e]){if((5&m[e])===E){let t=v[x[e]+k[n]];if(-1===t)break;if(4===m[t])return!0}break}return!1}function na(t){const n=m[t];let e=!1;if(0===n){if(t>15){const n=7&t;n>1&&1==(5&m[t-9])&&4===m[t-18]&&(ea(t,t-18,Ke(m[t-9])),e=!0),n<6&&1==(5&m[t-7])&&4===m[t-14]&&(ea(t,t-14,Ke(m[t-7])),e=!0)}return e}if(1===n){if(t<48){const n=7&t;n<6&&0==(5&m[t+9])&&4===m[t+18]&&(ea(t,t+18,Ke(m[t+9])),e=!0),n>1&&0==(5&m[t+7])&&4===m[t+14]&&(ea(t,t+14,Ke(m[t+7])),e=!0)}return e}if(2===n||3===n){for(let n=0;n<4;n++)for(let a=t;a=v[x[a]+k[n]],-1!==a;)if(4!==m[a]){if((5&m[a])===E){let r=v[x[a]+k[n]];if(-1===r)break;4===m[r]&&(ea(t,r,Ke(m[a])),e=!0)}break}return e}return e}function ea(t,n,e){let a=j[C];0===m[t]&&n<=7&&(e|=262144),1===m[t]&&n>=56&&(e|=262144),F[a]=t|qe(n)|e,X[a]=((t,n)=>q[Z(t,n)])(n,t),131072&e&&(X[a]+=H),196608&e&&(X[a]+=T),262144&e&&(X[a]+=T),j[C]++}function aa(){const n=0===R;let e=0,a=0;if(0==(u|w))return n?-ua+C:ua-C;if(0==(s|h))return n?ua-C:-ua+C;const r=B<35?b:M;for(let t=0;t<32;t++){const n=A[t],i=m[n];4!==i&&(0===i?e+=r[n]:1===i&&(a+=r[63-n]))}if(d<=4){if(at(),1010==g)return 0;let e=0;for(let t=0;t<32;t++){const n=A[t],a=m[n];4!==a&&(0===a?e+=Oe(n)+5:1===a&&(e+=Oe(63-n)+5))}e+=6*(4-u-s),0==(u|s)&&(e+=10);const a=function(t){0;ar++;const n=Number(0xffffffffn&t),e=Number(t>>32n);let a=2097151&n;const r=er[a];if(0===r)return 0;if(tr[a]===n&&nr[a]===e)return rr++,r;const i=1|e;a=a+i&2097151;const o=er[a];if(0===o)return 0;if(tr[a]===n&&nr[a]===e)return rr++,o;for(let t=2;t<=ir;t++){a=a+i&2097151;const t=er[a];if(0===t)return 0;if(tr[a]===n&&nr[a]===e)return rr++,t}return 0}(or());let r=0;if(0===t||t>=2){const a=u+w-(s+h);let i=0===t?-1:Math.sign(n?a:-a);0===i&&(i=-1),r=i*e}if(0!==a){if(rr++,a===Ga)return n?1e3-e-C:-1e3+e+C;if(a===Oa)return n?-1e3+e+C:1e3-e-C;if(a===$a)return n?r:-r}const i=sr(g);if(i===Ga)return n?1e3-e-C:-1e3+e+C;if(i===Oa)return n?-1e3+e+C:1e3-e-C;if(i===$a)return n?r:-r}return e+=u*H+w*T,a+=s*H+h*U,e+=2*(u+w),a+=2*(s+h),0===m[8]&&1===m[1]&&(a+=17),1===m[55]&&0===m[62]&&(e+=17),B<35&&(1===m[5]&&1===m[3]&&1===m[21]&&1===m[19]&&(a+=5,1!==m[14]&&1!==m[12]&&1!==m[10]||(a+=8),1===m[17]&&1===m[1]&&(a+=8),1===m[28]&&(a+=5)),0==m[17]&&(4==m[1]&&4==m[8]?e+=17:4==m[1]&&4==m[3]?e+=16:4==m[3]&&(e+=8)),0==m[19]&&(4==m[3]&&4==m[1]||4==m[3]&&4==m[5]?e+=17:(4==m[3]&&1==m[1]&&1==m[5]||4==m[1]&&1==m[3]&&1==m[8]||1==m[1]&&1==m[3])&&(e+=8)),0==m[21]&&(4==m[5]&&4==m[3]||4==m[5]&&4==m[7]?e+=17:(4==m[5]&&1==m[3]&&1==m[7]||4==m[3]&&1==m[5]&&1==m[7])&&(e+=8)),0==m[23]&&4==m[5]&&4==m[7]&&(e+=15),0==m[24]&&4==m[1]&&4==m[3]&&4==m[10]&&1==m[17]&&(e+=17),0==m[62]&&1==m[55]&&(e+=15)),n?e-a:a-e}let ra=0,ia=0,oa=0;function la(){D=!1;const t=Y[C],n=j[C],e=$[0][C];for(let a=t;a<n;a++)if(F[a]===e)return D=!0,void(X[a]+=ua)}function ca(t){let n=t,e=X[t];for(let a=t+1,r=j[C];a<r;a++)X[a]>e&&(e=X[n=a]);let a=F[t];F[t]=F[n],F[n]=a,a=X[t],X[t]=X[n],X[n]=a}function fa(t){const n=$[C],e=$[C+1],a=G[C+1];n[C]=F[t];for(let t=C+1;t<a;t++)n[t]=e[t];G[C]=a}const ua=1e4;function sa(t,n,e){if(0===e)return function t(n,e){G[C]=C;let a=aa();if(a>=e)return a;a>n&&(n=a);if(Ve(!1),j[C]===Y[C])return a;D&&la();for(let a=Y[C];a<j[C];a++){ca(a),wa(F[a]);let r=-t(-e,-n);if(ha(),r>=e)return r;r>n&&(n=r,fa(a))}return n}(t,n);const a=function(){0;const t=Ea;let n=0n;for(let e=0;e<32;e++){const a=A[e],r=m[a],i=t[e];r>=4||r<0||(n^=i[r])}1===R&&(n^=Ba);return n}(),r=function(t,n,e,a){0;Ta++;const r=Number(0xffffffffn&t)>>>0,i=Number(t>>32n&0xffffffffn)>>>0,o=4194303&r;if(Ya[o]!==r||ja[o]!==i)return{hit:!1,bestMove:0};const l=Xa[o],c=za[o],f=qa[o],u=function(t,n){return t>9e3?t-n:t<-9e3?t+n:t}(Ja[o],C);if(l>=n){if(Ha++,c===Na)return{hit:!0,score:u,bestMove:f};if(c===Da&&u<=e)return{hit:!0,score:u,bestMove:f};if(c===Wa&&u>=a)return{hit:!0,score:u,bestMove:f}}return{hit:!1,score:0,bestMove:f}}(a,e,t,n);if(r.bestMove&&0===C&&($[0][0]=r.bestMove),r.hit)return r.score;if(G[C]=C,Ve(Qe),j[C]==Y[C]){const t=-1e4+C;return Za(a,e,Na,t,0),t}j[C]-Y[C]==1&&u>1&&s>1&&e++,D&&la();let i=t,o=0,l=-1e4;for(let r=Y[C];r<j[C];r++){ca(r),wa(F[r]);let i=-sa(-n,-t,e-1);if(ha(),i>l&&(l=i,o=F[r]),i>=n)return Za(a,e,Wa,i,F[r]),i;i>t&&(t=i,c=Je(F[r]),f=ze(F[r]),w=e,q[Z(c,f)]=q[Z(c,f)]+w,fa(r))}var c,f,w;return Za(a,e,l>i?Na:Da,l,o),l}function wa(t){const n=ze(t),e=Je(t);if(z[C]=t,524288&t)return C++,C>_&&(_=C),pr(),!0;if(131072&t){let t=n>e?Ge(n)>Ge(e)?e+9:e+7:Ge(n)>Ge(e)?e-7:e-9;switch(J[C]=t,m[t]){case 0:u--;break;case 1:s--;break;case 2:w--;break;case 3:h--}d--,m[t]=4}else J[C]=-1;if(262144&t)switch(m[n]){case 0:m[e]=2,w++,u--;break;case 1:m[e]=3,h++,s--}else m[e]=m[n];return m[n]=4,C++,pr(),!0}function ha(){pr(),C--;const t=z[C],n=ze(t),e=Je(t);if(!(524288&t)){if(262144&t)switch(m[e]){case 2:m[n]=0,w--,u++;break;case 3:m[n]=1,h--,s++}else m[n]=m[e];if(131072&t){let n=J[C];switch(m[n]=(65536&t?2:0)|E,m[n]){case 0:u++;break;case 1:s++;break;case 2:w++;break;case 3:h++}d++}m[e]=4}}let da=0,ga=0,pa=-9999;async function ma(){const t=performance.now();C=0,_=0,q.fill(0);let n=0,a=1,r=0;const i=Math.min(3,Math.max(0,16-d>>1));for(;a>=10&&await ya(a,n,r),da=ga,D=!0,n=sa(-1e4,ua,a),ga=$[0][0],pa=n,r=performance.now()-t,!(r>=5e3);){if(a>=e&&n<-9988)return!1;if(a>=e&&r>=500&&(n<=-300||n>=300||a>=e+i))break;a++}return n>200&&(Rn(!1),Ln(!0)),Aa=performance.now()-t,Aa<1e3&&(Aa=1e3),Ca-=Math.floor(Aa/1e3),Ca<0&&(Ca=0),Ha=0,Ta=0,rr=0,ar=0,ra=0,ia=0,oa=0,!0}async function ya(t,n,e){await Ma(100)}async function Ma(t=60){await new Promise(n=>setTimeout(n,t))}function ba(){let t=0;if(L)switch(B){case 1:t=21|qe(28);break;case 3:t=7|qe(14);break;default:t=0}else switch(B){case 1:t=14|qe(21);break;case 3:t=7|qe(14);break;default:t=0}return t}const va="https://chnp.co.th/makhos/visit.php?";function xa(r){const u=r>0?"W":r<0?"L":"D";Math.round((performance.now()-i)/1e3);l+=t+u+" ";let s=va+"level="+t+"&result="+encodeURIComponent(l);t>0&&"W"===u&&(s+="&moves="+encodeURIComponent(o)),fetch(s);const w=r>0?"à¸„à¸¸à¸“à¸Šà¸™à¸°":r<0?"à¸„à¸¸à¸“à¹à¸žà¹‰":"à¹€à¸ªà¸¡à¸­à¸à¸±à¸™";_n(w+"!, à¹€à¸£à¸´à¹ˆà¸¡à¹€à¸à¸¡à¹ƒà¸«à¸¡à¹ˆ"),nt(w),function(e){n=t,e>0?(c++,f=0):e<0?(c=0,f++):(c=0,f=0);e>0&&0===n?(t=1,c=f=0):(2===c&&(t++,c=0),2===f&&(t--,f=0));t=Math.max(0,Math.min(2,t))}(r),e=t-1+10,t<=0&&(e=10),a=3,Ra()}function ka(){return at(),1010==g&&(4===m[7]||4===m[48])||!(P<6)&&(P>25||1111==g)}let Aa=0,Ia=180,Ca=180,_a=null;function La(t){const n=t%60;return Math.floor(t/60)+":"+(n<10?"0"+n:n)}function Sa(){St.textContent=La(Ca),Rt.textContent=La(Ia),Ca<=0&&(St.style.color="#fd0"),Ia<=0&&(Rt.style.color="#fd0")}function Ra(){St.style.color="#eee",Rt.style.color="#aaa",_a&&clearInterval(_a),_a=null,Sa()}let Ea=null,Ba=0n;function Pa(t){return 6364136223846793005n*BigInt(t)+1n&(1n<<64n)-1n}const Na=0,Da=1,Wa=2;let Ha=0,Ta=0,Ua=0,Fa=0;const Ya=new Uint32Array(4194304),ja=new Uint32Array(4194304),Xa=new Int16Array(4194304),za=new Int8Array(4194304),Ja=new Int32Array(4194304),qa=new Int32Array(4194304);function Za(t,n,e,a,r){if(0===n)return;Ua++;const i=Number(0xffffffffn&t)>>>0,o=Number(t>>32n&0xffffffffn)>>>0,l=4194303&i;if(a=function(t,n){return t>9e3?t+n:t<-9e3?t-n:t}(a,C),0===ja[l]&&0===Ya[l])return Ya[l]=i,ja[l]=o,Xa[l]=n>0?n:1,za[l]=e,Ja[l]=a,void(qa[l]=0|r);const c=Ya[l],f=ja[l],u=Xa[l],s=za[l];if(f!==o||c!==i)return Ya[l]=i,ja[l]=o,Xa[l]=n,za[l]=e,Ja[l]=a,void(qa[l]=0|r);if(Fa++,f===o&&c===i){if(s===Na&&e!==Na)return;if(n<u&&e!==Na)return;if(e===Na&&s===Na&&n<u)return;return Xa[l]=n,za[l]=e,Ja[l]=a,void(qa[l]=0|r)}}const $a=1,Ga=2,Oa=3;let Ka=0;const Qa=new Map,Va=(1n<<63n)-1n,tr=new Uint32Array(1<<21),nr=new Uint32Array(1<<21),er=new Uint8Array(1<<21);let ar=0,rr=0,ir=0;function or(){const t=0===R,n=Ea;let e=0n;for(let a=0;a<32;a++){const r=A[a],i=n[a];let o=m[r];o>=4||o<0||(t||4===o||(o^=1),e^=i[o])}return e&Va}function lr(t,n){const e=Number(0xffffffffn&t),a=Number(t>>32n);let r=2097151&e;const i=1|a;for(let t=0;t<1<<21;t++){if(0===er[r])return tr[r]=e,nr[r]=a,er[r]=n,t>ir&&(ir=t),!0;if(tr[r]===e&&nr[r]===a)return!1;r=r+i&2097151}return!1}function cr(t){let n="",e=0;for(;e<t.length;){let a=t[e];if(a>="0"&&a<="9"){let a=e+1;a<t.length&&t[a]>="0"&&t[a]<="9"&&a++;const r=parseInt(t.slice(e,a),10);n+="y".repeat(r),e=a}else n+=a,e++}return n}function fr(t){const n=[0,1,2,3,4];for(let t=0;t<32;t++)m[A[t]]=4;let e=0;for(let a=0;a<16;a++){const r=t.charCodeAt(a)-97;let i=Math.floor(r/5),o=r%5;m[A[e++]]=n[i],m[A[e++]]=n[o]}}const ur=new Map([[1001,2],[110,3],[101,1],[1010,1],[2010,2],[1020,3],[1110,2],[1011,3],[210,2],[1002,3],[2001,2],[120,3],[1101,2],[111,3],[201,2],[102,3],[2020,1],[2011,2],[2002,2],[220,3],[211,3],[202,1],[1120,3],[1111,1],[1102,2],[2110,2],[2101,2],[1021,3],[121,3],[1210,2],[1201,2],[1012,3],[112,3],[3010,2],[3001,2],[1030,3],[130,3],[310,2],[301,2],[1003,3],[103,3]]);function sr(t){return ur.get(t)??0}function wr(){let t=0,n=0,e=0,a=0;for(let r=0;r<32;r++){const i=m[A[r]];2===i?t++:0===i?n++:3===i?e++:1===i&&a++}return 1e3*t+100*n+10*e+a}const hr=new Map;let dr=0;function gr(){const t=function(){const t=0===R,n=t?[4n,5n,6n,7n]:[5n,4n,7n,6n];let e=0n;if(t)for(let t=0;t<32;t++){const a=m[A[t]];e=e*(a>=4?2n:8n)|(a>=4?0n:n[a])}else for(let t=31;t>=0;t--){const a=m[A[t]];e=e*(a>=4?2n:8n)|(a>=4?0n:n[a])}return e}(),n=hr.get(t);if(!n)return null;let e=n[Math.floor(Math.random()*n.length)];return e=Ze(e)|qe(63-Je(e))|63-ze(e),e}function pr(){R=0===R?1:0,E=0===R?1:0}window.init=function(){!function(){F.fill(0),X.fill(0),Y.fill(0),j.fill(0),z.fill(0),J.fill(0),G.fill(0),q.fill(0);for(let t=0;t<64;t++)$[t]=new Array(64).fill(0);for(let t=0;t<32;t++)I[A[t]]=t+1;ft=$t("boardWrapper"),ut=$t("extendWrapper"),st=$t("topBar"),wt=$t("bottomBar"),ht=$t("boardCanvas"),dt=ht.getContext("2d"),gt=$t("pieceCanvas"),pt=gt.getContext("2d"),mt=$t("animeCanvas"),yt=mt.getContext("2d"),Mt=Pt.createElement("canvas"),bt=Mt.getContext("2d"),vt=$t("message"),Bt=$t("topCenter"),xt=$t("version"),Lt=$t("newgame"),At=$t("styleSwitch"),It=$t("styleComp"),Ct=$t("soundSwitch"),_t=$t("cellNumSwitch"),kt=$t("footer"),St=$t("compTime"),Rt=$t("playerTime"),Et=$t("overlayText"),Ln(!1),Rn(!1),Ct.textContent="ðŸ”ˆ",yt.imageSmoothingEnabled=!1,bt.imageSmoothingEnabled=!1,function(){let t=124987n;Ea=[];for(let n=0;n<32;n++){Ea[n]=[];for(let e=0;e<10;e++)t=Pa(t),Ea[n][e]=t}t=Pa(t),Ba=t}()}(),function(){nt("Loading...");let t=0,n=0;for(let n=0;n<ct;n++)t+=ot[n].length;for(let e=0;e<ct;e++){Dt[e]=[];for(let a=0;a<ot[e].length;a++){const r=Dt[e][a]=new Image;r.onload=()=>{++n===t&&(fn=!0,un())},r.src=ot[e][a]}}}(),async function(t="DB0508.zip",n="DB0508.txt"){try{hr.clear(),dr=0;const e=await fetch(t);if(!e.ok)throw new Error("HTTP "+e.status);const a=await e.blob(),r=(await JSZip.loadAsync(a)).file(n);if(!r)throw new Error(`File ${n} not found`);const i=(await r.async("text")).split("\n").map(t=>t.trim()).filter(t=>t.length>=21);for(const t of i){const n=t.substring(0,16),e=t.substring(16,21),a=BigInt("0x"+n),r=Number("0x"+e);hr.has(a)||hr.set(a,[]),hr.get(a).push(r),dr++}}catch(t){}}(),async function(t="background2.jpg",n="description2.txt"){try{0;const e=await fetch(t);if(!e.ok)throw new Error("HTTP "+e.status);const a=await e.blob(),r=(await JSZip.loadAsync(a)).file(n);if(!r)throw new Error(`File ${n} not found`);const i=await r.async("text");tr.fill(0),nr.fill(0),er.fill(0),R=0;let o=0,l=0;const c=i.split("\n").map(t=>t.trim()).filter(t=>t&&!t.startsWith("#"));for(const t of c){const n={".":$a,"+":Ga,"-":Oa}[t[t.length-1]]||0,e=cr(t.substring(0,t.length-1));if(16!==e.length)continue;fr(e);const a=or(),r=wr();Qa.has(r)||Qa.set(r,{win:0,draw:0,loss:0,total:0,def:sr(r)});const i=Qa.get(r);n===$a?i.draw++:n===Ga?i.win++:n===Oa&&i.loss++,i.total++,lr(a,n)?o++:l++}for(const[t,n]of Qa.entries()){let t=!1;n.def===Ga&&n.win>0&&(t=!0),n.def===$a&&n.draw>0&&(t=!0),n.def===Oa&&n.loss>0&&(t=!0)}V(),R=0,Ka=o}catch(t){}}(),O()}